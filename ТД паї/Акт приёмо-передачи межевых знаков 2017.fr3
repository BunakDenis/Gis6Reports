<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="3.24" DotMatrixReport="False" EngineOptions.MaxMemSize="2000" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="За замовчуванням" ReportOptions.CreateDate="41359,6701227894" ReportOptions.Description.Text="" ReportOptions.LastChange="45249,6148137847" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;   AktCity, IspNameKogo, IspPreds, NameSmejn, SpisSmejn, ObjArea, ObjAddress, ObjAddress2, ObjIKN,&#13;&#10;   NameUser, NameUsers, NameUsers2, NaznFunk, CMejZN, DateGeod, OpisSmejn, FirstSm, IspPredsPost,&#13;&#10;   IspNameKto, MejnOpis, FirstL, NomMNext, NomMPrior, MarkNote, MarkOpis, NextSm : string;&#13;&#10;&#13;&#10;   Vladel, NSm, IsZmkn : boolean;&#13;&#10;&#13;&#10;   NomVl, MainScale, LineMejnNumb : integer;&#13;&#10;&#13;&#10;   LengMejnZN, Finish, FirstP : double;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;//===================================================================================================================================================================&#13;&#10;//         Дополнительно&#13;&#10;//===================================================================================================================================================================&#13;&#10;&#13;&#10;// Функция удвоения одинарной скобки для SQL-запросов&#13;&#10;function DoubleSkb(InStr : string) : string;&#13;&#10;begin&#13;&#10;  Result := '';&#13;&#10;&#13;&#10;  While Length(InStr) &#62; 0 do&#13;&#10;  begin&#13;&#10;    If Pos ('''', InStr) &#62; 0 then&#13;&#10;    begin&#13;&#10;      Result := Result + Copy(InStr, 1, Pos('''', InStr)) + '''';&#13;&#10;      Delete(InStr, 1, Pos ('''', InStr));&#13;&#10;    end&#13;&#10;    else&#13;&#10;    begin&#13;&#10;      Result := Result + InStr;&#13;&#10;      InStr  := '';&#13;&#10;    end;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;// Функция нахождения ближайшей точки объекта&#13;&#10;function FindObject(CoordX, CoordY : extended; NameObjPrior : string) : string;&#13;&#10;var&#13;&#10;   VectorX, VectorY, VectorDl, MinVector : extended;&#13;&#10;   NameObj : string;&#13;&#10;begin&#13;&#10;  NameObj    := ''; // Название ближайшего объекта&#13;&#10;  MinVector  := 1000000; // Минимальное расстояние&#13;&#10;  LengMejnZN := 0; // Расстояние к ближайшему знаку&#13;&#10;&#13;&#10;  MejnSlave.First;&#13;&#10;&#13;&#10;  While MejnSlave.EOF = false do&#13;&#10;  begin&#13;&#10;    // Определяем вектор&#13;&#10;    VectorX := CoordX - &#60;MejnSlave.&#34;X&#34;&#62;;&#13;&#10;    VectorY := CoordY - &#60;MejnSlave.&#34;Y&#34;&#62;;&#13;&#10;&#13;&#10;    // Расчитываем длину вектора&#13;&#10;    VectorDl := Sqrt((VectorX * VectorX) + (VectorY * VectorY));&#13;&#10;&#13;&#10;    If (MinVector &#62; VectorDl) then&#13;&#10;    begin&#13;&#10;      If (NameObjPrior &#60;&#62; &#60;MejnSlave.&#34;MarkNumber&#34;&#62;) and (VectorDl &#62; 0) then&#13;&#10;      begin&#13;&#10;        MinVector  := VectorDl;&#13;&#10;        NameObj    := &#60;MejnSlave.&#34;MarkNumber&#34;&#62;;&#13;&#10;        LengMejnZN := VectorDl;&#13;&#10;      end;&#13;&#10;    end;&#13;&#10;&#13;&#10;    MejnSlave.Next;&#13;&#10;  end;&#13;&#10;&#13;&#10;  Result := LowerFirst(Trim(NameObj));&#13;&#10;end;&#13;&#10;&#13;&#10;// Функция изменения номера межевого знака&#13;&#10;function EditMarkNomb(MarkNumbrT : string) : string;&#13;&#10;var&#13;&#10;   Mark : string;&#13;&#10;begin&#13;&#10;  Mark := Trim(MarkNumbrT);&#13;&#10;&#13;&#10;  If CBVisiblNomb.Checked then&#13;&#10;  begin&#13;&#10;    Case CBFormatL.ItemIndex of&#13;&#10;      0 : Mark := Copy(Mark, 1, 4) + '.___-____-______';&#13;&#10;      1 : Mark := '20___.___-' + Copy(Mark, 9, Length(Mark) - 8);&#13;&#10;      2 : Mark := '_____.___-' + Copy(Mark, 9, Length(Mark) - 8);&#13;&#10;      3 : Mark := Copy(Mark, 1, 4) + '.___-' + Copy(Mark, 9, Length(Mark) - 8);&#13;&#10;      4 : begin&#13;&#10;            If Copy(Mark, 6, 2) = '00' then&#13;&#10;              Mark := Copy(Mark, 1, 4) + '.___-' + Copy(Mark, 9, Length(Mark) - 8);&#13;&#10;          end;&#13;&#10;      5 : Mark := '_____.___-____-______';&#13;&#10;    end;&#13;&#10;  end;&#13;&#10;&#13;&#10;  Result := Mark;&#13;&#10;end;&#13;&#10;&#13;&#10;//===================================================================================================================================================================&#13;&#10;// Диалоговое окно&#13;&#10;//===================================================================================================================================================================&#13;&#10;&#13;&#10;procedure CheckBox1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  CBUsersL.Enabled := CheckBox1.Checked;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure RBUsers1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If RBUsers1.Checked then&#13;&#10;  begin&#13;&#10;    CBUsersL.Items.Clear;&#13;&#10;&#13;&#10;    ListUsers.Close;&#13;&#10;    ListUsers.SQL.Text := 'Set DateFormat dmy; ' +&#13;&#10;              'Select U.ID_TypeOwner, U.ID_People, U.ID_Firm, Max(U.NameUser) NameUser ' +&#13;&#10;              'From UserRec U Left Join TechDocLnk L on (L.ID_Object = ' + IntToStr(&#60;DM1.QbObject.&#34;ID_Object&#34;&#62;) + ') and (L.ID_User = U.ID_User) ' +&#13;&#10;                             'Left Join TechDoc T on (T.ID_TechDoc = L.ID_TechDoc) ' +&#13;&#10;              'Where (U.ID_Object = ' + IntToStr(&#60;DM1.QbObject.&#34;ID_Object&#34;&#62;) + ') and (U.DateFirst &#60;= GETDATE()) and ((U.DateLast is Null) or ' +&#13;&#10;                  '(U.DateLast &#62; GETDATE())) and (Not(T.ID_TypeTake in (3,5,7,9)) or (T.ID_TypeTake is Null)) ' +&#13;&#10;              'Group by U.ID_TypeOwner, U.ID_People, U.ID_Firm';&#13;&#10;    ListUsers.Open;&#13;&#10;&#13;&#10;    If ListUsers.RecordCount &#62; 0 then&#13;&#10;    begin&#13;&#10;      ListUsers.First;&#13;&#10;&#13;&#10;      While ListUsers.EOF = false do&#13;&#10;      begin&#13;&#10;        CBUsersL.Items.Add(&#60;ListUsers.&#34;NameUser&#34;&#62;);&#13;&#10;&#13;&#10;        ListUsers.Next;&#13;&#10;      end;&#13;&#10;&#13;&#10;      CBUsersL.ItemIndex := 0;&#13;&#10;    end;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure RBUsers2OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If RBUsers2.Checked then&#13;&#10;  begin&#13;&#10;    CBUsersL.Items.Clear;&#13;&#10;&#13;&#10;    ListUsers.Close;&#13;&#10;    ListUsers.SQL.Text := 'Set DateFormat dmy; ' +&#13;&#10;              'Select ID_TypeOwner, ID_People, ID_Firm, Max(NameUser) NameUser ' +&#13;&#10;              'From (Select (A.ID_LeaserType + 1) as ID_TypeOwner, A.ID_LeaserPeople as ID_People, A.ID_LeaserFirm as ID_Firm, A.LeaserName as NameUser ' +&#13;&#10;                  'From Lease A, LeasePoly L ' +&#13;&#10;                  'Where (L.ID_Object = ' + IntToStr(&#60;DM1.QbObject.&#34;ID_Object&#34;&#62;) + ') and (A.ID_Lease = L.ID_Lease) and (A.DateFirst &#60; GETDATE()) and ' +&#13;&#10;                      '((A.DateLast &#62; GETDATE()) or (A.DateLast is Null )) ' +&#13;&#10;                  'Union ' +&#13;&#10;                  'Select U.ID_TypeOwner, U.ID_People, U.ID_Firm, U.NameUser ' +&#13;&#10;                  'From UserRec U, TechDocLnk L, TechDoc T ' +&#13;&#10;                  'Where (U.ID_Object = ' + IntToStr(&#60;DM1.QbObject.&#34;ID_Object&#34;&#62;) + ') and (U.DateFirst &#60;= GETDATE()) and ((U.DateLast is Null) or ' +&#13;&#10;                      '(U.DateLast &#62; GETDATE())) and (L.ID_Object = ' + IntToStr(&#60;DM1.QbObject.&#34;ID_Object&#34;&#62;) + ') and (L.ID_User = U.ID_User) and ' +&#13;&#10;                      '(T.ID_TechDoc = L.ID_TechDoc) and (T.ID_TypeTake in (3,5,7,9))' +&#13;&#10;                ') t ' +&#13;&#10;              'Group by ID_TypeOwner, ID_People, ID_Firm';&#13;&#10;    ListUsers.Open;&#13;&#10;&#13;&#10;    If ListUsers.RecordCount &#62; 0 then&#13;&#10;    begin&#13;&#10;      ListUsers.First;&#13;&#10;&#13;&#10;      While ListUsers.EOF = false do&#13;&#10;      begin&#13;&#10;        CBUsersL.Items.Add(&#60;ListUsers.&#34;NameUser&#34;&#62;);&#13;&#10;&#13;&#10;        ListUsers.Next;&#13;&#10;      end;&#13;&#10;&#13;&#10;      CBUsersL.ItemIndex := 0;&#13;&#10;    end;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure EdMejnFOnExit(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  // Проверяем является ли число действительным&#13;&#10;  If ValidInt(EdMejnF.Text) = false then&#13;&#10;  begin&#13;&#10;    ShowMessage('Помилка! Значення має бути цілочисельним.');&#13;&#10;    EdMejnF.Text := '1';&#13;&#10;  end&#13;&#10;  else&#13;&#10;  begin&#13;&#10;    // Проверяем правильно ли задан диапазон&#13;&#10;    If (StrToInt(EdMejnF.Text) &#62; 0) and (StrToInt(EdMejnF.Text) &#60;= MejnZN.RecordCount) and&#13;&#10;       (StrToInt(EdMejnF.Text) &#60;= StrToInt(EdMejnL.Text)) then&#13;&#10;    begin&#13;&#10;      // Если изменён стандартный диапазон, то подразумевается, что нужен только список межевых знаков&#13;&#10;      If StrToInt(EdMejnF.Text) &#62; 1 then&#13;&#10;      begin&#13;&#10;        CBPageAkt.Checked  := false;&#13;&#10;        CBPageAbrs.Checked := false;&#13;&#10;        CBPageKrok.Checked := false;&#13;&#10;      end;&#13;&#10;    end&#13;&#10;    else&#13;&#10;    begin&#13;&#10;      ShowMessage('Помилка! Діапазон задано не вірно.');&#13;&#10;      EdMejnF.Text := '1';&#13;&#10;    end;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure EdMejnLOnExit(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  // Проверяем является ли число действительным&#13;&#10;  If ValidInt(EdMejnL.Text) = false then&#13;&#10;  begin&#13;&#10;    ShowMessage('Помилка! Значення має бути цілочисельним.');&#13;&#10;    EdMejnL.Text := IntToStr(MejnZN.RecordCount);&#13;&#10;  end&#13;&#10;  else&#13;&#10;  begin&#13;&#10;    // Проверяем правильно ли задан диапазон&#13;&#10;    If (StrToInt(EdMejnL.Text) &#60; 1) or (StrToInt(EdMejnL.Text) &#62; MejnZN.RecordCount) or&#13;&#10;       (StrToInt(EdMejnF.Text) &#62; StrToInt(EdMejnL.Text)) then&#13;&#10;    begin&#13;&#10;      ShowMessage('Помилка! Діапазон задано не вірно.');&#13;&#10;      EdMejnL.Text := IntToStr(MejnZN.RecordCount);&#13;&#10;    end;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure LDScaleOnEnter(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If ValidInt(LDScale.Text) = false then&#13;&#10;    RaiseException('Помилка! Масштаб для схеми ділянки вказано не вірно!')&#13;&#10;  else&#13;&#10;    If (StrToInt(LDScale.Text) &#60; 1) or (StrToInt(LDScale.Text) &#62; 16000000) then&#13;&#10;      RaiseException('Помилка! Масштаб для схеми ділянки вказано не вірно!');&#13;&#10;end;&#13;&#10;&#13;&#10;procedure CBPageAktOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  CBPodpsSmj.Enabled := CBPageAkt.Checked;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure CBPageKrokOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  CBDlineMejn.Enabled := CBPageKrok.Checked;&#13;&#10;&#13;&#10;  If (CBPageKrok.Checked = false) and (CBPageSpis.Checked = false) then&#13;&#10;  begin&#13;&#10;    CBVisiblNomb.Enabled := false;&#13;&#10;    CBVisKoord.Enabled   := false;&#13;&#10;    CBFormatL.Enabled    := false;&#13;&#10;    CBVisiblNomb.Checked := false;&#13;&#10;  end&#13;&#10;  else&#13;&#10;  begin&#13;&#10;    CBVisiblNomb.Enabled := true;&#13;&#10;    CBVisKoord.Enabled   := true;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure CBPageSpisOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Label1.Enabled  := CBPageSpis.Checked;&#13;&#10;  Label2.Enabled  := CBPageSpis.Checked;&#13;&#10;  Label3.Enabled  := CBPageSpis.Checked;&#13;&#10;  EdMejnF.Enabled := CBPageSpis.Checked;&#13;&#10;  EdMejnL.Enabled := CBPageSpis.Checked;&#13;&#10;  Label4.Enabled  := CBPageSpis.Checked;&#13;&#10;  Label7.Enabled  := CBPageSpis.Checked;&#13;&#10;  LDScale.Enabled := CBPageSpis.Checked;&#13;&#10;&#13;&#10;&#13;&#10;  If (CBPageKrok.Checked = false) and (CBPageSpis.Checked = false) then&#13;&#10;  begin&#13;&#10;    CBVisiblNomb.Enabled := false;&#13;&#10;    CBVisKoord.Enabled   := false;&#13;&#10;    CBFormatL.Enabled    := false;&#13;&#10;    CBVisiblNomb.Checked := false;&#13;&#10;  end&#13;&#10;  else&#13;&#10;  begin&#13;&#10;    CBVisiblNomb.Enabled := true;&#13;&#10;    CBVisKoord.Enabled   := true;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure CBVisiblNombOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  CBFormatL.Enabled := CBVisiblNomb.Checked;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  // Включаем или отключаем необходимые страницы&#13;&#10;  PageAkt.Visible    := CBPageAkt.Checked;&#13;&#10;  PageAbris.Visible  := CBPageAbrs.Checked;&#13;&#10;  PageSpMejn.Visible := CBPageSpis.Checked;&#13;&#10;  PageKrok.Visible   := CBPageKrok.Checked;&#13;&#10;&#13;&#10;&#13;&#10;  //-----------------------------------------------------------------------------------------------------------------------------------------------------------------&#13;&#10;  // Владельцы участка&#13;&#10;&#13;&#10;  NameUsers  := ''; // Список&#13;&#10;  NameUsers2 := ''; // Список для второй страницы&#13;&#10;&#13;&#10;  ListUsers.Close;&#13;&#10;&#13;&#10;  If CheckBox1.Checked then&#13;&#10;  begin&#13;&#10;    If RBUsers1.Checked then // Если владельцы&#13;&#10;    begin&#13;&#10;      Vladel := true;&#13;&#10;      ListUsers.SQL.Text := 'Select ID_TypeOwner, ID_People, ID_Firm, NameUser ' +&#13;&#10;              'From UserRec ' +&#13;&#10;              'Where (ID_Object = ' + IntToStr(&#60;DM1.QbObject.&#34;ID_Object&#34;&#62;) + ') and (NameUser = ''' + DoubleSkb(CBUsersL.Text) + ''')';&#13;&#10;    end&#13;&#10;    else&#13;&#10;    begin // Если пользователи&#13;&#10;      Vladel := false;&#13;&#10;      ListUsers.SQL.Text := 'Select ID_TypeOwner, ID_People, ID_Firm, Max(NameUser) NameUser ' +&#13;&#10;              'From (Select (A.ID_LeaserType + 1) as ID_TypeOwner, A.ID_LeaserPeople as ID_People, A.ID_LeaserFirm as ID_Firm, A.LeaserName as NameUser ' +&#13;&#10;                  'From Lease A, LeasePoly L ' +&#13;&#10;                  'Where (L.ID_Object = ' + IntToStr(&#60;DM1.QbObject.&#34;ID_Object&#34;&#62;) + ') and (A.ID_Lease = L.ID_Lease) and (A.LeaserName = ''' +&#13;&#10;                      DoubleSkb(CBUsersL.Text) + ''') ' +&#13;&#10;                  'Union ' +&#13;&#10;                  'Select ID_TypeOwner, ID_People, ID_Firm, NameUser ' +&#13;&#10;                  'From UserRec ' +&#13;&#10;                  'Where (ID_Object = ' + IntToStr(&#60;DM1.QbObject.&#34;ID_Object&#34;&#62;) + ') and (NameUser = ''' + DoubleSkb(CBUsersL.Text) + ''')' +&#13;&#10;                ') t ' +&#13;&#10;              'Group by ID_TypeOwner, ID_People, ID_Firm';&#13;&#10;    end;&#13;&#10;  end&#13;&#10;  else&#13;&#10;  begin&#13;&#10;    If RBUsers1.Checked then // Если владельцы&#13;&#10;    begin&#13;&#10;      Vladel := true;&#13;&#10;      ListUsers.SQL.Text := 'Set DateFormat dmy; ' +&#13;&#10;              'Select U.ID_TypeOwner, U.ID_People, U.ID_Firm, Max(U.NameUser) NameUser ' +&#13;&#10;              'From UserRec U Left Join TechDocLnk L on (L.ID_Object = ' + IntToStr(&#60;DM1.QbObject.&#34;ID_Object&#34;&#62;) + ') and (L.ID_User = U.ID_User) ' +&#13;&#10;                             'Left Join TechDoc T on (T.ID_TechDoc = L.ID_TechDoc) ' +&#13;&#10;              'Where (U.ID_Object = ' + IntToStr(&#60;DM1.QbObject.&#34;ID_Object&#34;&#62;) + ') and (U.DateFirst &#60;= GETDATE()) and ((U.DateLast is Null) or ' +&#13;&#10;                  '(U.DateLast &#62; GETDATE())) and (Not(T.ID_TypeTake in (3,5,7,9)) or (T.ID_TypeTake is Null)) ' +&#13;&#10;              'Group by U.ID_TypeOwner, U.ID_People, U.ID_Firm';&#13;&#10;    end&#13;&#10;    else&#13;&#10;    begin // Если пользователи&#13;&#10;      Vladel := false;&#13;&#10;      ListUsers.SQL.Text := 'Set DateFormat dmy; ' +&#13;&#10;              'Select ID_TypeOwner, ID_People, ID_Firm, Max(NameUser) NameUser ' +&#13;&#10;              'From (Select (A.ID_LeaserType + 1) as ID_TypeOwner, A.ID_LeaserPeople as ID_People, A.ID_LeaserFirm as ID_Firm, A.LeaserName as NameUser ' +&#13;&#10;                  'From Lease A, LeasePoly L ' +&#13;&#10;                  'Where (L.ID_Object = ' + IntToStr(&#60;DM1.QbObject.&#34;ID_Object&#34;&#62;) + ') and (A.ID_Lease = L.ID_Lease) and (A.DateFirst &#60; GETDATE()) and ' +&#13;&#10;                      '((A.DateLast &#62; GETDATE()) or (A.DateLast is Null )) ' +&#13;&#10;                  'Union ' +&#13;&#10;                  'Select U.ID_TypeOwner, U.ID_People, U.ID_Firm, U.NameUser ' +&#13;&#10;                  'From UserRec U, TechDocLnk L, TechDoc T ' +&#13;&#10;                  'Where (U.ID_Object = ' + IntToStr(&#60;DM1.QbObject.&#34;ID_Object&#34;&#62;) + ') and (U.DateFirst &#60;= GETDATE()) and ((U.DateLast is Null) or ' +&#13;&#10;                      '(U.DateLast &#62; GETDATE())) and (L.ID_Object = ' + IntToStr(&#60;DM1.QbObject.&#34;ID_Object&#34;&#62;) + ') and (L.ID_User = U.ID_User) and ' +&#13;&#10;                      '(T.ID_TechDoc = L.ID_TechDoc) and (T.ID_TypeTake in (3,5,7,9))' +&#13;&#10;                ') t ' +&#13;&#10;              'Group by ID_TypeOwner, ID_People, ID_Firm';&#13;&#10;    end;&#13;&#10;  end;&#13;&#10;&#13;&#10;  ListUsers.Open;&#13;&#10;&#13;&#10;  If ListUsers.RecordCount &#62; 0 then&#13;&#10;  begin&#13;&#10;    ListUsers.First;&#13;&#10;&#13;&#10;    While ListUsers.EOF = false do&#13;&#10;    begin&#13;&#10;      If LocateData('DM2.TbTypeOwner', 'ID_TypeOwner', &#60;ListUsers.&#34;ID_TypeOwner&#34;&#62;) = True Then&#13;&#10;      begin&#13;&#10;        If (&#60;DM2.TbTypeOwner.&#34;ID_TypeUser&#34;&#62; = True) And (LocateData( 'DM1.QsFirm', 'ID_Firm', &#60;ListUsers.&#34;ID_Firm&#34;&#62;) = True) Then&#13;&#10;          NameUsers := NameUsers + &#60;DM1.QsFirm.&#34;Name_Small&#34;&#62; + ', ';&#13;&#10;&#13;&#10;        If (&#60;DM2.TbTypeOwner.&#34;ID_TypeUser&#34;&#62; = False) And (LocateData( 'DM1.QsPeople', 'ID_People', &#60;ListUsers.&#34;ID_People&#34;&#62;) = True) Then&#13;&#10;          NameUsers := NameUsers + FamilyShort(&#60;DM1.QsPeople.&#34;Family&#34;&#62;) + ', ';&#13;&#10;      end;&#13;&#10;&#13;&#10;      ListUsers.Next;&#13;&#10;    end;&#13;&#10;&#13;&#10;    NameUsers := Copy(NameUsers, 1, Length(NameUsers) - 2);&#13;&#10;  end;&#13;&#10;&#13;&#10;  NameUsers2 := NameUsers;&#13;&#10;&#13;&#10;  If Length(Trim(NameUsers)) = 0 then // Проверяем есть ли владельцы или пользователи&#13;&#10;  begin&#13;&#10;     NameUsers  := '                                                                           ' +&#13;&#10;                   '                                                                           ' +&#13;&#10;                   '                                             ';&#13;&#10;     NameUsers2 := '                                                                           ' +&#13;&#10;                   '                                     ';&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;//===================================================================================================================================================================&#13;&#10;// Страница 1&#13;&#10;//===================================================================================================================================================================&#13;&#10;&#13;&#10;procedure DDUsersOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  NomVl := NomVl + 1;&#13;&#10;&#13;&#10;  NameUser := ''; // Название владельца или пользователя&#13;&#10;&#13;&#10;  If Vladel then&#13;&#10;    NameUser := 'Власник земельної ділянки &#60;b&#62;'&#13;&#10;  else&#13;&#10;    NameUser := 'Користувач земельної ділянки &#60;b&#62;';&#13;&#10;&#13;&#10;  If LocateData('DM2.TbTypeOwner', 'ID_TypeOwner', &#60;ListUsers.&#34;ID_TypeOwner&#34;&#62;) = True Then&#13;&#10;  begin&#13;&#10;    If (&#60;DM2.TbTypeOwner.&#34;ID_TypeUser&#34;&#62; = True) And (LocateData( 'DM1.QsFirm', 'ID_Firm', &#60;ListUsers.&#34;ID_Firm&#34;&#62;) = True) Then&#13;&#10;      NameUser := NameUser + &#60;DM1.QsFirm.&#34;Name_Who&#34;&#62; + '&#60;/b&#62;';&#13;&#10;&#13;&#10;    If (&#60;DM2.TbTypeOwner.&#34;ID_TypeUser&#34;&#62; = False) And (LocateData( 'DM1.QsPeople', 'ID_People', &#60;ListUsers.&#34;ID_People&#34;&#62;) = True) Then&#13;&#10;      NameUser := NameUser + &#60;DM1.QsPeople.&#34;Family&#34;&#62; + '&#60;/b&#62;';&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure SmejHeadOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  NomVl     := 0;&#13;&#10;  SpisSmejn := ''; // Список смежников, которых уже выводили&#13;&#10;&#13;&#10;  If OpisSmej.RecordCount &#62; 0 then // Если нету смежеств на участке, то не выводить&#13;&#10;     SmejHead.Visible := true&#13;&#10;  else&#13;&#10;     SmejHead.Visible := false&#13;&#10;end;&#13;&#10;&#13;&#10;procedure SmejnDDOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  SmejnDD.Visible := true;&#13;&#10;  NameSmejn := ''; // Название смежника&#13;&#10;  NomVl     := NomVl + 1;&#13;&#10;&#13;&#10;  If (&#60;OpisSmej.&#34;ID_TypeUser&#34;&#62; &#60; 3) and (LocateData('DM1.QsPeople', 'ID_People', &#60;OpisSmej.&#34;ID_People&#34;&#62;)= true) then&#13;&#10;    NameSmejn := &#60;DM1.QsPeople.&#34;Family&#34;&#62;&#13;&#10;  else&#13;&#10;  begin&#13;&#10;    If LocateData('DM1.QsFirm', 'ID_Firm', &#60;OpisSmej.&#34;ID_Firm&#34;&#62;)= true then&#13;&#10;      NameSmejn := &#60;DM1.QsFirm.&#34;Name_Who&#34;&#62;&#13;&#10;    else&#13;&#10;    begin&#13;&#10;      If Length(Trim(&#60;OpisSmej.&#34;OpisDel&#34;&#62;)) &#62; 0 then&#13;&#10;        NameSmejn := &#60;OpisSmej.&#34;OpisDel&#34;&#62;;&#13;&#10;    end;&#13;&#10;  end;&#13;&#10;&#13;&#10;  If (Length(Trim(NameSmejn)) &#60; 2) or (Pos(NameSmejn + ', ', SpisSmejn) &#62; 0) then&#13;&#10;  begin&#13;&#10;    SmejnDD.Visible := false;&#13;&#10;    NomVl := NomVl - 1;&#13;&#10;  end&#13;&#10;  else&#13;&#10;    SpisSmejn := SpisSmejn + NameSmejn + ', ';&#13;&#10;end;&#13;&#10;&#13;&#10;procedure SubdetailData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  NameUser := ''; // Название владельца или пользователя&#13;&#10;&#13;&#10;  If LocateData('DM2.TbTypeOwner', 'ID_TypeOwner', &#60;ListUsers.&#34;ID_TypeOwner&#34;&#62;) = True Then&#13;&#10;  begin&#13;&#10;     If (&#60;DM2.TbTypeOwner.&#34;ID_TypeUser&#34;&#62; = True) And (LocateData( 'DM1.QsFirm', 'ID_Firm', &#60;ListUsers.&#34;ID_Firm&#34;&#62;) = True) Then&#13;&#10;     begin&#13;&#10;       If (LocateData( 'DM1.QsPeople', 'ID_People', &#60;DM1.QsFirm.&#34;ID_People&#34;&#62;) = True) Then&#13;&#10;          NameUser := &#60;DM1.QsPeople.&#34;Family&#34;&#62;;&#13;&#10;     end;&#13;&#10;&#13;&#10;     If (&#60;DM2.TbTypeOwner.&#34;ID_TypeUser&#34;&#62; = False) And (LocateData( 'DM1.QsPeople', 'ID_People', &#60;ListUsers.&#34;ID_People&#34;&#62;) = True) Then&#13;&#10;       NameUser  := &#60;DM1.QsPeople.&#34;Family&#34;&#62;;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure DetailData7OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  SpisSmejn := ''; // Список смежников, которых уже выводили&#13;&#10;end;&#13;&#10;&#13;&#10;procedure SDDSmejnOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;&#13;&#10;  NameSmejn := ''; // Название смежника&#13;&#10;&#13;&#10;  If (&#60;OpisSmej.&#34;ID_TypeUser&#34;&#62; &#60; 3) and (LocateData('DM1.QsPeople', 'ID_People', &#60;OpisSmej.&#34;ID_People&#34;&#62;)= true) then&#13;&#10;    NameSmejn := &#60;DM1.QsPeople.&#34;Family&#34;&#62;&#13;&#10;  else&#13;&#10;  begin&#13;&#10;    If LocateData('DM1.QsFirm', 'ID_Firm', &#60;OpisSmej.&#34;ID_Firm&#34;&#62;)= true then&#13;&#10;    begin&#13;&#10;       If (LocateData( 'DM1.QsPeople', 'ID_People', &#60;DM1.QsFirm.&#34;ID_People&#34;&#62;) = True) Then&#13;&#10;          NameSmejn := &#60;DM1.QsPeople.&#34;Family&#34;&#62;;&#13;&#10;    end&#13;&#10;    else&#13;&#10;    begin&#13;&#10;       If (Length(Trim(&#60;OpisSmej.&#34;OpisDel&#34;&#62;)) &#62; 0) and (&#60;OpisSmej.&#34;ID_TypeUser&#34;&#62; &#60; 3) then&#13;&#10;         NameSmejn := &#60;OpisSmej.&#34;OpisDel&#34;&#62;;&#13;&#10;    end;&#13;&#10;  end;&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;//===================================================================================================================================================================&#13;&#10;// Страница 2&#13;&#10;//===================================================================================================================================================================&#13;&#10;&#13;&#10;procedure Picture1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  With Picture1, Engine do&#13;&#10;  begin&#13;&#10;//    VisibleGisLayer(0, true);   // участок&#13;&#10;//    VisibleGisLayer(1, true);   // план&#13;&#10;//    VisibleGisLayer(2, false);   // агрогруппы&#13;&#10;//    VisibleGisLayer(3, false);   // таблица расчётов&#13;&#10;//    VisibleGisLayer(4, true);   // обозначения&#13;&#10;//    VisibleGisLayer(5, true);   // ситуация&#13;&#10;//    VisibleGisLayer(6, true);   // чертёж&#13;&#10;//    VisibleGisLayer(7, false);   // каталог координат&#13;&#10;//    VisibleGisLayer(8, true);   // горизонтали&#13;&#10;//    VisibleGisLayer(9, true);   // оформление&#13;&#10;//    VisibleGisLayer(10, false);  // общий&#13;&#10;//    VisibleGisLayer(11, true);  // сервитуты&#13;&#10;//    VisibleGisLayer(12, true);  // ограничения&#13;&#10;//    VisibleGisLayer(13, true);  // аренда&#13;&#10;//    VisibleGisLayer(14, false);  // теодолитный ход&#13;&#10;//    VisibleGisLayer(15, false);  // карта&#13;&#10;//    VisibleGisLayer(16, false);  // проектные дороги&#13;&#10;//    VisibleGisLayer(17, false);  // сторонние земли&#13;&#10;//    VisibleGisLayer(18, false);  // секущая линия&#13;&#10;//    VisibleGisLayer(19, false);  // межевые знаки&#13;&#10;//    VisibleGisLayer(20, false);  // коммуникации&#13;&#10;&#13;&#10;    DrawWmf(Width * 10 / (2560/6773), Height * 10 /(2560/6773), MainScale);&#13;&#10;    Loadfromfile( StartPath +'\gis.wmf');&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure DDOpisSmOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  OpisSmejn := ''; // Описание смежников&#13;&#10;  Finish    := 0; // Номер координаты следующего смежества&#13;&#10;  FirstP    := 0; // Замыкающая координата (номер)&#13;&#10;  FirstSm   := ''; // Замыкающая буква&#13;&#10;  NextSm    := ''; // Следующая буква&#13;&#10;  IsZmkn    := false; // Статус закнутости полигона&#13;&#10;&#13;&#10;  // SQL-запрос для таблицы смежеств&#13;&#10;  OpisSmej.SQL.Text := 'Select P.ID_Polygon, P.Number, V.* ' +&#13;&#10;          'From Polygon L, Point P, Vector V ' +&#13;&#10;          'Where (L.ID_Object = ' + IntToStr(&#60;DM1.QbObject.&#34;ID_Object&#34;&#62;) + ') and (P.ID_Polygon = L.ID_Polygon) and (V.ID_Point = P.ID_Point) ' +&#13;&#10;          'Order By P.ID_Polygon, P.SortNumber, V.Litera';&#13;&#10;  OpisSmej.Open;&#13;&#10;&#13;&#10;  // SQL-запрос для списка всех координат&#13;&#10;  Points.SQL.Text := 'Select P.Number ' +&#13;&#10;          'From Polygon L, Point P ' +&#13;&#10;          'Where (L.ID_Object = ' + IntToStr(&#60;DM1.QbObject.&#34;ID_Object&#34;&#62;) + ') and (P.ID_Polygon = L.ID_Polygon) ' +&#13;&#10;          'Order By P.ID_Polygon, P.SortNumber';&#13;&#10;  Points.Open;&#13;&#10;&#13;&#10;  If OpisSmej.RecordCount &#62; 0 then&#13;&#10;  begin&#13;&#10;    OpisSmej.First;&#13;&#10;    Points.First;&#13;&#10;&#13;&#10;    FirstSm := &#60;OpisSmej.&#34;Litera&#34;&#62;; // Первая буква смежеств&#13;&#10;    FirstP  := &#60;Points.&#34;Number&#34;&#62;; // Первая координата (номер)&#13;&#10;&#13;&#10;    Points.Next;&#13;&#10;&#13;&#10;    While OpisSmej.EOF = false do&#13;&#10;    begin&#13;&#10;      // По умолчанию считаем, что в диапазоне нет замыкания&#13;&#10;      IsZmkn := false;&#13;&#10;&#13;&#10;      // Берём букву текущего смежества&#13;&#10;      OpisSmejn := OpisSmejn + 'Від ' + &#60;OpisSmej.&#34;Litera&#34;&#62; + ' до ';&#13;&#10;&#13;&#10;      // Переходим на следующее смежество и берём его номер и букву&#13;&#10;      OpisSmej.Next;&#13;&#10;      Finish := &#60;OpisSmej.&#34;Number&#34;&#62;;&#13;&#10;      NextSm := &#60;OpisSmej.&#34;Litera&#34;&#62;;&#13;&#10;&#13;&#10;      // Если ещё не конец списка, то возвращаемся на текущее смежество&#13;&#10;      If OpisSmej.EOF = false then&#13;&#10;        OpisSmej.Prior&#13;&#10;      else&#13;&#10;      begin&#13;&#10;        Finish := FirstP;&#13;&#10;        NextSm := FirstSm;&#13;&#10;      end;&#13;&#10;&#13;&#10;      // Пробегаемся по диапазону, чтобы проверить будет ли замыкание&#13;&#10;      While (&#60;Points.&#34;Number&#34;&#62; &#60; Finish) and (Points.EOF = false) do&#13;&#10;      begin&#13;&#10;        If &#60;Points.&#34;Number&#34;&#62; = FirstP then&#13;&#10;          IsZmkn := true;&#13;&#10;&#13;&#10;        Points.Next;&#13;&#10;&#13;&#10;        // Сразу после замыкающей координаты запоминаем новую замыкающую&#13;&#10;        If IsZmkn then&#13;&#10;        begin&#13;&#10;          FirstP := &#60;Points.&#34;Number&#34;&#62;;&#13;&#10;          Points.Next;&#13;&#10;          Break;&#13;&#10;        end;&#13;&#10;      end;&#13;&#10;&#13;&#10;      If IsZmkn or Points.EOF then&#13;&#10;      begin&#13;&#10;        OpisSmejn := OpisSmejn + FirstSm;&#13;&#10;        FirstSm   := NextSm; // Первая буква смежеств&#13;&#10;      end&#13;&#10;      else&#13;&#10;        OpisSmejn := OpisSmejn + NextSm;&#13;&#10;&#13;&#10;      // Читаем данные смежника&#13;&#10;      OpisSmejn := OpisSmejn + ' ';&#13;&#10;&#13;&#10;      If Length(Trim(&#60;OpisSmej.&#34;OpisMej&#34;&#62;)) &#62; 0 then&#13;&#10;        OpisSmejn := OpisSmejn + &#60;OpisSmej.&#34;OpisMej&#34;&#62; + ' ';&#13;&#10;&#13;&#10;      If Length(Trim(&#60;OpisSmej.&#34;OpisDel&#34;&#62;)) &#62; 0 then&#13;&#10;        OpisSmejn := OpisSmejn + &#60;OpisSmej.&#34;OpisDel&#34;&#62; + ' ';&#13;&#10;&#13;&#10;      If (Length(Trim(&#60;OpisSmej.&#34;OpisAdr&#34;&#62;)) &#62; 0) or (Length(Trim(&#60;OpisSmej.&#34;IKN&#34;&#62;)) &#62; 0) then&#13;&#10;      begin&#13;&#10;        OpisSmejn := OpisSmejn + '(';&#13;&#10;&#13;&#10;        If Length(Trim(&#60;OpisSmej.&#34;IKN&#34;&#62;)) &#62; 0 then&#13;&#10;          OpisSmejn := OpisSmejn + &#60;OpisSmej.&#34;IKN&#34;&#62; + ' ';&#13;&#10;&#13;&#10;        If Length(Trim(&#60;OpisSmej.&#34;OpisAdr&#34;&#62;)) &#62; 0 then&#13;&#10;          OpisSmejn := OpisSmejn + &#60;OpisSmej.&#34;OpisAdr&#34;&#62;;&#13;&#10;&#13;&#10;        OpisSmejn := Trim(OpisSmejn) + ')';&#13;&#10;      end;&#13;&#10;&#13;&#10;      OpisSmejn := Trim(OpisSmejn) + #13;&#13;&#10;&#13;&#10;      OpisSmej.Next;&#13;&#10;    end;&#13;&#10;&#13;&#10;    OpisSmejn := Trim(OpisSmejn);&#13;&#10;  end;&#13;&#10;&#13;&#10;  Points.Close;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;//===================================================================================================================================================================&#13;&#10;// Страница 3&#13;&#10;//===================================================================================================================================================================&#13;&#10;&#13;&#10;procedure MasterData2OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  LineMejnNumb := LineMejnNumb + 1;&#13;&#10;  MarkNote     := ''; // Описание межевого знака&#13;&#10;&#13;&#10;  If (LineMejnNumb &#62;= StrToInt(EdMejnF.Text)) and (LineMejnNumb &#60;= StrToInt(EdMejnL.Text)) then&#13;&#10;  begin&#13;&#10;    MasterData2.Visible := true;&#13;&#10;&#13;&#10;    //---------------------------------------------------------------------------------------------------------------------------------------------------------------&#13;&#10;    // Рисунок&#13;&#10;&#13;&#10;    With Picture2, Engine do&#13;&#10;    begin&#13;&#10;      GisShift(&#60;MejnZN.&#34;X&#34;&#62;, &#60;MejnZN.&#34;Y&#34;&#62;);&#13;&#10;&#13;&#10;      DrawWmf(Width * 10 / (2560/6773), Height * 10 /(2560/6773), StrToInt(LDScale.Text));&#13;&#10;      Loadfromfile( StartPath +'\gis.wmf');&#13;&#10;    end;&#13;&#10;&#13;&#10;    //---------------------------------------------------------------------------------------------------------------------------------------------------------------&#13;&#10;    // Описание межевого знака&#13;&#10;&#13;&#10;    MarkNote := Trim(&#60;MejnZN.&#34;Note&#34;&#62;);&#13;&#10;&#13;&#10;    If CBVisKoord.Checked then&#13;&#10;    begin&#13;&#10;      If Length(MarkNote) &#62; 0 then&#13;&#10;        MarkNote := MarkNote + #13;&#13;&#10;&#13;&#10;      MarkNote := MarkNote + 'Межовий знак розташований за координатами: X - ';&#13;&#10;      MarkNote := MarkNote + FormatFloat(fdPoint, &#60;MejnZN.&#34;X&#34;&#62;) + ' Y - ';&#13;&#10;      MarkNote := MarkNote + FormatFloat(fdPoint, &#60;MejnZN.&#34;Y&#34;&#62;);&#13;&#10;    end;&#13;&#10;  end&#13;&#10;  else&#13;&#10;    MasterData2.Visible := false;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure ListUsPidp3OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  NameUser := ''; // Название владельца или пользователя&#13;&#10;&#13;&#10;  If LocateData('DM2.TbTypeOwner', 'ID_TypeOwner', &#60;ListUsers.&#34;ID_TypeOwner&#34;&#62;) = True Then&#13;&#10;  begin&#13;&#10;     If (&#60;DM2.TbTypeOwner.&#34;ID_TypeUser&#34;&#62; = True) And (LocateData( 'DM1.QsFirm', 'ID_Firm', &#60;ListUsers.&#34;ID_Firm&#34;&#62;) = True) Then&#13;&#10;     begin&#13;&#10;       If (LocateData( 'DM1.QsPeople', 'ID_People', &#60;DM1.QsFirm.&#34;ID_People&#34;&#62;) = True) Then&#13;&#10;          NameUser := &#60;DM1.QsPeople.&#34;Family&#34;&#62;;&#13;&#10;     end;&#13;&#10;&#13;&#10;     If (&#60;DM2.TbTypeOwner.&#34;ID_TypeUser&#34;&#62; = False) And (LocateData( 'DM1.QsPeople', 'ID_People', &#60;ListUsers.&#34;ID_People&#34;&#62;) = True) Then&#13;&#10;       NameUser  := &#60;DM1.QsPeople.&#34;Family&#34;&#62;;&#13;&#10;  end;&#13;&#10;&#13;&#10;  If &#60;Line&#62; = 1 then&#13;&#10;  begin&#13;&#10;    IspPidps1.Visible := true;&#13;&#10;    IspPidps2.Visible := true;&#13;&#10;  end&#13;&#10;  else&#13;&#10;  begin&#13;&#10;    IspPidps1.Visible := false;&#13;&#10;    IspPidps2.Visible := false;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;//===================================================================================================================================================================&#13;&#10;// Страница 4&#13;&#10;//===================================================================================================================================================================&#13;&#10;&#13;&#10;procedure MasterData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;   Litera, OpisM : string;&#13;&#10;begin&#13;&#10;  //-----------------------------------------------------------------------------------------------------------------------------------------------------------------&#13;&#10;  // Описание межевого знака&#13;&#10;&#13;&#10;  MarkNote := Trim(&#60;MejnZN.&#34;Note&#34;&#62;);&#13;&#10;&#13;&#10;  If CBVisKoord.Checked then&#13;&#10;  begin&#13;&#10;    If Length(MarkNote) &#62; 0 then&#13;&#10;      MarkNote := MarkNote + #13;&#13;&#10;&#13;&#10;    MarkNote := MarkNote + 'Межовий знак розташований за координатами: X - ';&#13;&#10;    MarkNote := MarkNote + FormatFloat(fdPoint, &#60;MejnZN.&#34;X&#34;&#62;) + ' Y - ';&#13;&#10;    MarkNote := MarkNote + FormatFloat(fdPoint, &#60;MejnZN.&#34;Y&#34;&#62;);&#13;&#10;  end;&#13;&#10;&#13;&#10;  //-----------------------------------------------------------------------------------------------------------------------------------------------------------------&#13;&#10;  // Определяем смежество для межевого знака&#13;&#10;&#13;&#10;  MejnOpis := ''; // Описание смежества в котором лежит межевой знак&#13;&#10;  Litera   := ''; // Буква смежества&#13;&#10;  OpisM    := ''; // Описание смежества&#13;&#10;  NSm      := false; // Было ли вхождение в смежество?&#13;&#10;&#13;&#10;  OpisSmej.First;&#13;&#10;&#13;&#10;  FirstL := &#60;OpisSmej.&#34;Litera&#34;&#62;; // Первая буква смежества&#13;&#10;&#13;&#10;  While OpisSmej.EOF = false do&#13;&#10;  begin&#13;&#10;    Litera := &#60;OpisSmej.&#34;Litera&#34;&#62;;&#13;&#10;    OpisM  := ' - ';&#13;&#10;&#13;&#10;    If Length(Trim(&#60;OpisSmej.&#34;OpisMej&#34;&#62;)) &#62; 0 then&#13;&#10;      OpisM := OpisM + &#60;OpisSmej.&#34;OpisMej&#34;&#62;;&#13;&#10;&#13;&#10;    If Length(Trim(&#60;OpisSmej.&#34;OpisDel&#34;&#62;)) &#62; 0 then&#13;&#10;      OpisM := OpisM + ' ' + &#60;OpisSmej.&#34;OpisDel&#34;&#62;;&#13;&#10;&#13;&#10;&#13;&#10;    If &#60;OpisSmej.&#34;Number&#34;&#62; = &#60;MejnZN.&#34;Number&#34;&#62; then&#13;&#10;    begin&#13;&#10;      MejnOpis := 'Межові знаки зі сторони ' + Litera;&#13;&#10;      NSm      := true;&#13;&#10;    end;&#13;&#10;&#13;&#10;    OpisSmej.Next;&#13;&#10;&#13;&#10;    If ((&#60;OpisSmej.&#34;Number&#34;&#62; &#62; &#60;MejnZN.&#34;Number&#34;&#62;) or OpisSmej.EOF) and (NSm = false) then&#13;&#10;    begin&#13;&#10;      MejnOpis := 'Межові знаки зі сторони ' + Litera;&#13;&#10;      NSm      := true;&#13;&#10;    end;&#13;&#10;&#13;&#10;    If (NSm = true) and (OpisSmej.EOF = false) then&#13;&#10;    begin&#13;&#10;      MejnOpis := MejnOpis + '-' + &#60;OpisSmej.&#34;Litera&#34;&#62; + OpisM;&#13;&#10;      Break;&#13;&#10;    end&#13;&#10;    else&#13;&#10;    begin&#13;&#10;      If NSm then&#13;&#10;        MejnOpis := MejnOpis + '-' + FirstL + OpisM;&#13;&#10;    end;&#13;&#10;  end;&#13;&#10;&#13;&#10;  //-----------------------------------------------------------------------------------------------------------------------------------------------------------------&#13;&#10;  // Видимость на смежные межевые знаки&#13;&#10;&#13;&#10;  MarkOpis := MejnOpis; // Описание&#13;&#10;&#13;&#10;  If Length(MarkOpis) &#62; 0 then&#13;&#10;    MarkOpis := MarkOpis + #13;&#13;&#10;&#13;&#10;  // Ближайшие&#13;&#10;  If CBDlineMejn.Checked then&#13;&#10;  begin&#13;&#10;    // Находим ближайший межевой знак&#13;&#10;    NomMNext := FindObject(&#60;MejnZN.&#34;X&#34;&#62;, &#60;MejnZN.&#34;Y&#34;&#62;, '');&#13;&#10;&#13;&#10;    MarkOpis := MarkOpis + 'Межовий знак розташований на відстані ' + FormatFloat('0.00', LengMejnZN);&#13;&#10;&#13;&#10;    // Находим следующий ближайший межевой знак&#13;&#10;    NomMPrior := FindObject(&#60;MejnZN.&#34;X&#34;&#62;, &#60;MejnZN.&#34;Y&#34;&#62;, NomMNext);&#13;&#10;&#13;&#10;    // Если указано, очищаем номер знака&#13;&#10;    NomMNext  := EditMarkNomb(NomMNext);&#13;&#10;    NomMPrior := EditMarkNomb(NomMPrior);&#13;&#10;&#13;&#10;    MarkOpis := MarkOpis + ' м. від знаку № ' + NomMNext + ' та ';&#13;&#10;    MarkOpis := MarkOpis + FormatFloat('0.00', LengMejnZN) + ' м. від знаку № ' + NomMPrior;&#13;&#10;  end&#13;&#10;  else&#13;&#10;  begin&#13;&#10;    // Находим следующий ближайший межевой знак&#13;&#10;    NomMNext  := FindObject(&#60;MejnZN.&#34;X&#34;&#62;, &#60;MejnZN.&#34;Y&#34;&#62;, '');&#13;&#10;    NomMPrior := FindObject(&#60;MejnZN.&#34;X&#34;&#62;, &#60;MejnZN.&#34;Y&#34;&#62;, NomMNext);&#13;&#10;&#13;&#10;    // Если указано, очищаем номер знака&#13;&#10;    NomMNext  := EditMarkNomb(NomMNext);&#13;&#10;    NomMPrior := EditMarkNomb(NomMPrior);&#13;&#10;&#13;&#10;    MarkOpis := MarkOpis + NomMPrior + #13 + NomMNext;&#13;&#10;  end;&#13;&#10;&#13;&#10;  If Length(Trim(&#60;MejnZN.&#34;Visible&#34;&#62;)) &#62; 0 then&#13;&#10;    MarkOpis := MarkOpis + #13 + Trim(&#60;MejnZN.&#34;Visible&#34;&#62;);&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Footer2OnAfterPrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  // Возвращаем масштаб для камеральных&#13;&#10;  GisScale(MainScale);&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Child3OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If Engine.FreeSpace &#62; Child3.Height then&#13;&#10;    Child3.Visible := true&#13;&#10;  else&#13;&#10;    Child3.Visible := false;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;//===================================================================================================================================================================&#13;&#10;// Конец шаблона&#13;&#10;//===================================================================================================================================================================&#13;&#10;&#13;&#10;procedure frxReportGis6OnStopReport(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  // Закрываем временные таблицы&#13;&#10;  OpisSmej.Close;&#13;&#10;  ListArend.Close;&#13;&#10;  ListUsers.Close;&#13;&#10;  UserRec.Close;&#13;&#10;  MejnZN.Close;&#13;&#10;  MejnSlave.Close;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;//===================================================================================================================================================================&#13;&#10;// Основной скрипт&#13;&#10;//===================================================================================================================================================================&#13;&#10;&#13;&#10;begin&#13;&#10;  //-----------------------------------------------------------------------------------------------------------------------------------------------------------------&#13;&#10;  // Адрес&#13;&#10;&#13;&#10;  GetKUATU(&#60;DM1.QbObject.&#34;IKN&#34;&#62;);&#13;&#10;&#13;&#10;  AktCity := ''; // Населённый пункт шапки&#13;&#10;&#13;&#10;  If (Length(Name_Area) &#62; 0) and ((Pos('м.', Name_Area) &#62; 0) or (Pos('с.', Name_Area) &#62; 0) or (Pos('смт ', Name_Area) &#62; 0) or (Pos('с-', Name_Area) &#62; 0)) then&#13;&#10;    AktCity := Name_Area;&#13;&#10;&#13;&#10;  If (Length(Name_Region) &#62; 0) and ((Pos('м.', Name_Region) &#62; 0) or (Pos('с.', Name_Region) &#62; 0) or (Pos('смт ', Name_Region) &#62; 0) or (Pos( 'с-', Name_Region) &#62; 0)) then&#13;&#10;    AktCity := Name_Region;&#13;&#10;&#13;&#10;  If (Length(Name_Advice) &#62; 0) and ((Pos('м.', Name_Advice) &#62; 0) or (Pos('с.', Name_Advice) &#62; 0) or (Pos('смт ', Name_Advice) &#62; 0) or (Pos('с-', Name_Advice) &#62; 0)) then&#13;&#10;    AktCity := Name_Advice;&#13;&#10;&#13;&#10;  If (Length(Name_Place) &#62; 0) and ((Pos('м.', Name_Place) &#62; 0) or (Pos('с.', Name_Place) &#62; 0) or (Pos('смт ', Name_Place) &#62; 0) or (Pos('с-', Name_Place) &#62; 0)) then&#13;&#10;    AktCity := Name_Place;&#13;&#10;&#13;&#10;  // Если нету населённого пункта - сельский совет&#13;&#10;&#13;&#10;  If (Trim(AktCity) = '') and (Length(Name_Advice) &#62; 0) and (Pos('м.', Name_Advice) = 0) and (Pos('с.', Name_Advice) = 0) and (Pos('смт ', Name_Advice) = 0) and (Pos('с-', Name_Advice) = 0) then&#13;&#10;    AktCity := Name_Advice;&#13;&#10;&#13;&#10;  AktCity := Trim(AktCity);&#13;&#10;&#13;&#10;  //-----------------------------------------------------------------------------------------------------------------------------------------------------------------&#13;&#10;  // Описание смежеств&#13;&#10;&#13;&#10;  // SQL-запрос для создание таблицы смежеств&#13;&#10;  OpisSmej.SQL.Text := 'Select P.ID_Polygon, P.Number, V.* ' +&#13;&#10;              'From Polygon L, Point P, Vector V ' +&#13;&#10;              'Where (L.ID_Object = ' + IntToStr(&#60;DM1.QbObject.&#34;ID_Object&#34;&#62;) + ') and (P.ID_Polygon = L.ID_Polygon) and (V.ID_Point = P.ID_Point) ' +&#13;&#10;              'Order by P.ID_Polygon, P.SortNumber, V.Litera';&#13;&#10;  OpisSmej.Open;&#13;&#10;&#13;&#10;  //-----------------------------------------------------------------------------------------------------------------------------------------------------------------&#13;&#10;  // Владельцы или пользователи&#13;&#10;&#13;&#10;  // Поумолчанию всё отключено, так как не знаем кто у нас есть&#13;&#10;  RBUsers1.Enabled := false;&#13;&#10;  RBUsers1.Checked := false;&#13;&#10;  RBUsers2.Enabled := false;&#13;&#10;  RBUsers2.Checked := false;&#13;&#10;&#13;&#10;  // Проверяем есть ли владельцы&#13;&#10;  If RecordCount('DM1.ListUser') &#62; 0 then&#13;&#10;  begin&#13;&#10;    RBUsers1.Enabled := true;&#13;&#10;    RBUsers1.Checked := true;&#13;&#10;    RBUsers2.Checked := false;&#13;&#10;  end;&#13;&#10;&#13;&#10;  NomVl := 1;&#13;&#10;&#13;&#10;  If RecordCount('DM1.QiTechDoc') &#62; 0 Then&#13;&#10;  begin // Если есть пользование участком&#13;&#10;    If (&#60;DM1.QiTechDoc.&#34;ID_TypeTake&#34;&#62; = 3) or (&#60;DM1.QiTechDoc.&#34;ID_TypeTake&#34;&#62; = 5) or&#13;&#10;       (&#60;DM1.QiTechDoc.&#34;ID_TypeTake&#34;&#62; = 7) or (&#60;DM1.QiTechDoc.&#34;ID_TypeTake&#34;&#62; = 9) then&#13;&#10;    begin&#13;&#10;      RBUsers2.Enabled := true;&#13;&#10;      RBUsers2.Checked := true;&#13;&#10;      RBUsers1.Checked := false;&#13;&#10;    end;&#13;&#10;  end;&#13;&#10;&#13;&#10;  //-----------------------------------------------------------------------------------------------------------------------------------------------------------------&#13;&#10;  // Аренда&#13;&#10;&#13;&#10;  // Отбираем действительные договора аренды&#13;&#10;  ListArend.SQL.Text := 'Set DateFormat dmy; ' +&#13;&#10;              'Select A.* ' +&#13;&#10;              'From [Object] O, Lease A, LeasePoly L ' +&#13;&#10;              'Where (O.ID_Object = ' + IntToStr(&#60;DM1.QbObject.&#34;ID_Object&#34;&#62;) + ') and (L.ID_Object = O.ID_Object) and (A.ID_Lease = L.ID_Lease) and ' +&#13;&#10;                  '(A.DateFirst &#60; GETDATE()) and ((A.DateLast &#62; GETDATE()) or (A.DateLast is Null))';&#13;&#10;  ListArend.Open;&#13;&#10;&#13;&#10;  If ListArend.RecordCount &#62; 0 then // Если есть аренда, значит это пользование участком&#13;&#10;  begin&#13;&#10;    RBUsers2.Enabled := true;&#13;&#10;    RBUsers2.Checked := true;&#13;&#10;    RBUsers1.Checked := false;&#13;&#10;  end;&#13;&#10;&#13;&#10;  //-----------------------------------------------------------------------------------------------------------------------------------------------------------------&#13;&#10;  // Список&#13;&#10;&#13;&#10;  If RBUsers1.Checked then // Если владельцы&#13;&#10;  begin&#13;&#10;    ListUsers.SQL.Text := 'Set DateFormat dmy; ' +&#13;&#10;              'Select U.ID_TypeOwner, U.ID_People, U.ID_Firm, Max(U.NameUser) NameUser ' +&#13;&#10;              'From UserRec U Left Join TechDocLnk L on (L.ID_Object = ' + IntToStr(&#60;DM1.QbObject.&#34;ID_Object&#34;&#62;) + ') and (L.ID_User = U.ID_User) ' +&#13;&#10;                             'Left Join TechDoc T on (T.ID_TechDoc = L.ID_TechDoc) ' +&#13;&#10;              'Where (U.ID_Object = ' + IntToStr(&#60;DM1.QbObject.&#34;ID_Object&#34;&#62;) + ') and (U.DateFirst &#60;= GETDATE()) and ((U.DateLast is Null) or ' +&#13;&#10;                  '(U.DateLast &#62; GETDATE())) and (Not(T.ID_TypeTake in (3,5,7,9)) or (T.ID_TypeTake is Null)) ' +&#13;&#10;              'Group by U.ID_TypeOwner, U.ID_People, U.ID_Firm';&#13;&#10;  end&#13;&#10;  else&#13;&#10;  begin // Если пользователи&#13;&#10;    ListUsers.SQL.Text := 'Set DateFormat dmy; ' +&#13;&#10;              'Select ID_TypeOwner, ID_People, ID_Firm, Max(NameUser) NameUser ' +&#13;&#10;              'From (Select (A.ID_LeaserType + 1) as ID_TypeOwner, A.ID_LeaserPeople as ID_People, A.ID_LeaserFirm as ID_Firm, A.LeaserName as NameUser ' +&#13;&#10;                  'From Lease A, LeasePoly L ' +&#13;&#10;                  'Where (L.ID_Object = ' + IntToStr(&#60;DM1.QbObject.&#34;ID_Object&#34;&#62;) + ') and (A.ID_Lease = L.ID_Lease) and (A.DateFirst &#60; GETDATE()) and ' +&#13;&#10;                      '((A.DateLast &#62; GETDATE()) or (A.DateLast is Null )) ' +&#13;&#10;                  'Union ' +&#13;&#10;                  'Select U.ID_TypeOwner, U.ID_People, U.ID_Firm, U.NameUser ' +&#13;&#10;                  'From UserRec U, TechDocLnk L, TechDoc T ' +&#13;&#10;                  'Where (U.ID_Object = ' + IntToStr(&#60;DM1.QbObject.&#34;ID_Object&#34;&#62;) + ') and (U.DateFirst &#60;= GETDATE()) and ((U.DateLast is Null) or ' +&#13;&#10;                      '(U.DateLast &#62; GETDATE())) and (L.ID_Object = ' + IntToStr(&#60;DM1.QbObject.&#34;ID_Object&#34;&#62;) + ') and (L.ID_User = U.ID_User) and ' +&#13;&#10;                      '(T.ID_TechDoc = L.ID_TechDoc) and (T.ID_TypeTake in (3,5,7,9))' +&#13;&#10;                ') t ' +&#13;&#10;              'Group by ID_TypeOwner, ID_People, ID_Firm';&#13;&#10;  end;&#13;&#10;  ListUsers.Open;&#13;&#10;&#13;&#10;  If ListUsers.RecordCount &#62; 0 then&#13;&#10;  begin&#13;&#10;    ListUsers.First;&#13;&#10;&#13;&#10;    CBUsersL.Items.Clear;&#13;&#10;&#13;&#10;    While ListUsers.EOF = false do&#13;&#10;    begin&#13;&#10;      CBUsersL.Items.Add(&#60;ListUsers.&#34;NameUser&#34;&#62;);&#13;&#10;&#13;&#10;      ListUsers.Next;&#13;&#10;    end;&#13;&#10;&#13;&#10;    CBUsersL.ItemIndex := 0;&#13;&#10;  end;&#13;&#10;&#13;&#10;  //-----------------------------------------------------------------------------------------------------------------------------------------------------------------&#13;&#10;  // Межевые знаки&#13;&#10;&#13;&#10;  CMejZN := '              '; // Количество межевых знаков&#13;&#10;  LineMejnNumb := 0; // Нумерация списка межевых знаков&#13;&#10;&#13;&#10;  // Главная таблица межевых знаков&#13;&#10;  MejnZN.SQL.Text := 'Select M.MarkNumber, M.Note, M.Visible, P.* ' +&#13;&#10;            'From Point P, Polygon L, LandMark M ' +&#13;&#10;            'Where (L.ID_Object = ' + IntToStr(&#60;DM1.QbObject.&#34;ID_Object&#34;&#62;) + ') and (P.ID_Polygon = L.ID_Polygon) and (M.ID_LandMark = P.ID_LandMark) ' +&#13;&#10;            'Order by P.Number';&#13;&#10;  MejnZN.Open;&#13;&#10;&#13;&#10;  If MejnZN.RecordCount &#62; 0 then&#13;&#10;  begin&#13;&#10;     CMejZN := IntToStr(MejnZN.RecordCount);&#13;&#10;     EdMejnL.Text := IntToStr(MejnZN.RecordCount);&#13;&#10;  end&#13;&#10;  else&#13;&#10;  begin&#13;&#10;    // Отключаем не нужные элементы&#13;&#10;    CBPageSpis.Enabled   := false;&#13;&#10;    CBPageSpis.Checked   := false;&#13;&#10;    CBPageKrok.Enabled   := false;&#13;&#10;    CBPageKrok.Checked   := false;&#13;&#10;    Label1.Enabled       := false;&#13;&#10;    Label2.Enabled       := false;&#13;&#10;    Label3.Enabled       := false;&#13;&#10;    EdMejnF.Enabled      := false;&#13;&#10;    EdMejnL.Enabled      := false;&#13;&#10;    Label4.Enabled       := false;&#13;&#10;    Label7.Enabled       := false;&#13;&#10;    LDScale.Enabled      := false;&#13;&#10;    CBVisiblNomb.Enabled := false;&#13;&#10;    CBVisKoord.Enabled   := false;&#13;&#10;    CBDlineMejn.Enabled  := false;&#13;&#10;&#13;&#10;    ShowMessage('Помилка! На вашій ділянці не має межових знаків.');&#13;&#10;  end;&#13;&#10;&#13;&#10;  // Дополнительная таблица межевых знаков&#13;&#10;  MejnSlave.SQL.Text := 'Select M.MarkNumber, P.X, P.Y ' +&#13;&#10;            'From Point P, Polygon L, LandMark M ' +&#13;&#10;            'Where (L.ID_Object = ' + IntToStr(&#60;DM1.QbObject.&#34;ID_Object&#34;&#62;) + ') and (P.ID_Polygon = L.ID_Polygon) and (M.ID_LandMark = P.ID_LandMark) ' +&#13;&#10;            'Order by P.Number';&#13;&#10;  MejnSlave.Open;&#13;&#10;&#13;&#10;  //-----------------------------------------------------------------------------------------------------------------------------------------------------------------&#13;&#10;  // Параметры участка&#13;&#10;&#13;&#10;  ObjIKN      := '                                            '; // Кадастровый номер участка&#13;&#10;  ObjAddress  := '                                                                           ' +&#13;&#10;                 '                                                                           ' +&#13;&#10;                 '                                      '; // Адрес участка&#13;&#10;  ObjAddress2 := '                                                                           ' +&#13;&#10;             '                                             '; // Адрес участка для второй страницы&#13;&#10;  ObjArea     := '                        '; // Площадь земельного участка&#13;&#10;&#13;&#10;  If Length(Trim(&#60;DM1.QbObject.&#34;IKN&#34;&#62;)) &#62; 0 then&#13;&#10;    ObjIKN := &#60;DM1.QbObject.&#34;IKN&#34;&#62;;&#13;&#10;&#13;&#10;  If Length(Trim(&#60;DM1.QbObject.&#34;Address&#34;&#62;)) &#62; 0 then&#13;&#10;  begin&#13;&#10;    ObjAddress  := &#60;DM1.QbObject.&#34;Address&#34;&#62;;&#13;&#10;    ObjAddress2 := &#60;DM1.QbObject.&#34;Address&#34;&#62;;&#13;&#10;  end;&#13;&#10;&#13;&#10;  If &#60;DM1.QbObject.&#34;Area_Type&#34;&#62; = 1 then&#13;&#10;    ObjArea := FormatFloat(fdLandAreaG, &#60;DM1.QbObject.&#34;Area&#34;&#62; /10000) + ' га'&#13;&#10;  else&#13;&#10;    ObjArea := FormatFloat(fdLandAreaM, &#60;DM1.QbObject.&#34;Area&#34;&#62;) + ' кв.м.';&#13;&#10;&#13;&#10;  //-----------------------------------------------------------------------------------------------------------------------------------------------------------------&#13;&#10;  // Техническая документация&#13;&#10;&#13;&#10;  IspNameKto   := ''; // Название исполнителя (кого)&#13;&#10;  IspNameKogo  := ''; // Название исполнителя (кого)&#13;&#10;  IspPreds     := ''; // Представитель исполнителя&#13;&#10;  IspPredsPost := ''; // Должность представителя исполнителя&#13;&#10;  DateGeod     := ''; // Дата выполнения геодезических работ&#13;&#10;&#13;&#10;  DataOpen('DM1.QiTechDoc');&#13;&#10;&#13;&#10;  If RecordCount('DM1.QiTechDoc') &#62; 0 Then&#13;&#10;  begin&#13;&#10;    If &#60;DM1.QiTechDoc.&#34;Reg_Date&#34;&#62; &#62; 0 then&#13;&#10;      DateGeod := DateToStr(&#60;DM1.QiTechDoc.&#34;Reg_Date&#34;&#62;);&#13;&#10;&#13;&#10;    If LocateData('DM1.QbFirm', 'ID_Firm', &#60;DM1.QiTechDoc.&#34;ID_Firm&#34;&#62;) Then&#13;&#10;    begin&#13;&#10;      IspNameKogo := &#60;DM1.QbFirm.&#34;Name_Whom&#34;&#62;;&#13;&#10;      IspNameKto  := &#60;DM1.QbFirm.&#34;Name_Who&#34;&#62;;&#13;&#10;&#13;&#10;      If RecordCount('DM1.TbWorking') &#62; 0 then&#13;&#10;      begin&#13;&#10;        If LocateData('DM1.TbWorking', 'ID_People', &#60;DM1.QiTechDoc.&#34;ID_People&#34;&#62;) then&#13;&#10;        begin&#13;&#10;          If LocateData('DM2.TbTypeWorking', 'ID_TypeWorking', &#60;DM1.TbWorking.&#34;ID_TypeWorking&#34;&#62;)= true then&#13;&#10;             IspPredsPost := UpperFirst(Trim(&#60;DM2.TbTypeWorking.&#34;Name&#34;&#62;)) +' ' +&#60;DM1.QbFirm.&#34;Name_Whom&#34;&#62;;&#13;&#10;&#13;&#10;          If LocateData('DM1.QbPeople', 'ID_People', &#60;DM1.TbWorking.&#34;ID_People&#34;&#62;) then&#13;&#10;             IspPreds := &#60;DM1.QbPeople.&#34;Family&#34;&#62;;&#13;&#10;        end;&#13;&#10;      end;&#13;&#10;    end;&#13;&#10;  end;&#13;&#10;&#13;&#10;  If Length(IspNameKogo) = 0 then&#13;&#10;    IspNameKogo := Firm_Whom;&#13;&#10;  If Length(IspNameKto) = 0 then&#13;&#10;    IspNameKto := Firm_Who;&#13;&#10;  If Length(IspPreds) = 0 then&#13;&#10;    IspPreds := ChiefFio;&#13;&#10;  If Length(IspPredsPost) = 0 then&#13;&#10;    IspPredsPost := ChiefName + Firm_Whom;&#13;&#10;&#13;&#10;&#13;&#10;  If Length(Trim(DateGeod)) = 0 then&#13;&#10;  begin&#13;&#10;    DateGeod := '                                                                              ' +&#13;&#10;                '                                                 ';&#13;&#10;  end;&#13;&#10;&#13;&#10;  //-----------------------------------------------------------------------------------------------------------------------------------------------------------------&#13;&#10;  // Функциональное и целевые назначения&#13;&#10;&#13;&#10;  NaznFunk := '                                                                               ' +&#13;&#10;              '                  '; // Функциональное назначение&#13;&#10;&#13;&#10;  If LocateData( 'DM2.TbUses', 'ID_Uses', &#60;DM1.TbUser.&#34;ID_Uses&#34;&#62;) = True Then&#13;&#10;  begin&#13;&#10;    NaznFunk := Trim(&#60;DM2.TbUses.&#34;Name&#34;&#62;);&#13;&#10;    NaznFunk := Lowercase(Copy(NaznFunk, 1, 1)) + Copy(NaznFunk, 2, Length(NaznFunk));&#13;&#10;&#13;&#10;    If (Pos('для ', NaznFunk) = 1) or (Pos('Для ', NaznFunk) = 1) then&#13;&#10;      NaznFunk := Copy(NaznFunk, 5, Length(NaznFunk) - 4);&#13;&#10;  end;&#13;&#10;&#13;&#10;  //-----------------------------------------------------------------------------------------------------------------------------------------------------------------&#13;&#10;  // Рисунок&#13;&#10;&#13;&#10;  MainScale := 0; // Масштаб для абрыса&#13;&#10;&#13;&#10;  If ValidInt(Scale) then&#13;&#10;  begin&#13;&#10;    MainScale    := StrToInt(Scale);&#13;&#10;    LDScale.Text := IntToStr(Round(StrToInt(Scale) / 2));&#13;&#10;  end;&#13;&#10;&#13;&#10;  //-----------------------------------------------------------------------------------------------------------------------------------------------------------------&#13;&#10;  // Прочее&#13;&#10;&#13;&#10;  CBFormatL.ItemIndex := 2;&#13;&#10;end." OnStopReport="frxReportGis6OnStopReport" PropData="044C65667403C00203546F70025008446174617365747301010C3700000020446174615365743D22444D312E6651624465636973696F6E2220446174615365744E616D653D22444D312E51624465636973696F6E2200010C2F00000020446174615365743D22444D312E6651624669726D2220446174615365744E616D653D22444D312E51624669726D2200010C3300000020446174615365743D22444D312E6651624F626A6563742220446174615365744E616D653D22444D312E51624F626A6563742200010C3300000020446174615365743D22444D312E66516250656F706C652220446174615365744E616D653D22444D312E516250656F706C652200010C3500000020446174615365743D22444D312E66516954656368446F632220446174615365744E616D653D22444D312E516954656368446F632200010C2F00000020446174615365743D22444D312E6651734669726D2220446174615365744E616D653D22444D312E51734669726D2200010C3300000020446174615365743D22444D312E66517350656F706C652220446174615365744E616D653D22444D312E517350656F706C652200010C2F00000020446174615365743D22444D312E665462557365722220446174615365744E616D653D22444D312E5462557365722200010C3500000020446174615365743D22444D312E665462576F726B696E672220446174615365744E616D653D22444D312E5462576F726B696E672200010C3900000020446174615365743D22444D322E665462547970654F776E65722220446174615365744E616D653D22444D322E5462547970654F776E65722200010C3D00000020446174615365743D22444D322E66546254797065576F726B696E672220446174615365744E616D653D22444D322E546254797065576F726B696E672200010C2F00000020446174615365743D22444D322E665462557365732220446174615365744E616D653D22444D322E5462557365732200010C2C00000020446174615365743D224C6973744172656E642220446174615365744E616D653D224C6973744172656E642200010C2C00000020446174615365743D224C69737455736572732220446174615365744E616D653D224C69737455736572732200010C2C00000020446174615365743D224D656A6E536C6176652220446174615365744E616D653D224D656A6E536C6176652200010C2600000020446174615365743D224D656A6E5A4E2220446174615365744E616D653D224D656A6E5A4E2200010C2A00000020446174615365743D224F706973536D656A2220446174615365744E616D653D224F706973536D656A2200010C2600000020446174615365743D22506F696E74732220446174615365744E616D653D22506F696E74732200010C2800000020446174615365743D22557365725265632220446174615365744E616D653D2255736572526563220000095661726961626C65730100055374796C650100">
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Налаштування" Height="330" Left="459" Top="236" Width="522">
    <TfrxGroupBoxControl Name="GroupBox4" Left="8" Top="184" Width="228" Height="76" Caption=" Номери межових знаків " Color="-16777201">
      <TfrxCheckBoxControl Name="CBVisiblNomb" Left="12" Top="20" Width="201" Height="17" Caption="Ставити нижні підкреслення" Color="-16777201" OnClick="CBVisiblNombOnClick"/>
      <TfrxComboBoxControl Name="CBFormatL" Left="12" Top="44" Width="204" Height="20" Enabled="False" Color="-16777211" Items.Text="2019.___-____-______&#13;&#10;20___.___-000-00001&#13;&#10;_____.___-000-00001&#13;&#10;2019.___-000-00001&#13;&#10;2019.(якщо 00, то ___)-000-00001&#13;&#10;_____.___-____-______" ItemIndex="-1"/>
    </TfrxGroupBoxControl>
    <TfrxButtonControl Name="Button1" Left="176" Top="268" Width="75" Height="25" Caption="Ок" ModalResult="1" OnClick="Button1OnClick"/>
    <TfrxButtonControl Name="Button2" Left="264" Top="268" Width="75" Height="25" Caption="Відміна" ModalResult="2"/>
    <TfrxGroupBoxControl Name="GroupBox1" Left="8" Top="4" Width="228" Height="176" Caption=" Структура документу " Color="-16777201">
      <TfrxCheckBoxControl Name="CBPageAkt" Left="12" Top="20" Width="109" Height="17" Caption="Відображати акт" Checked="True" State="cbChecked" Color="-16777201" OnClick="CBPageAktOnClick"/>
      <TfrxCheckBoxControl Name="CBPageAbrs" Left="12" Top="44" Width="121" Height="17" Caption="Відображати абрис" Checked="True" State="cbChecked" Color="-16777201"/>
      <TfrxCheckBoxControl Name="CBPageSpis" Left="12" Top="68" Width="205" Height="17" Caption="Відображати список межових знаків" Checked="True" State="cbChecked" Color="-16777201" OnClick="CBPageSpisOnClick"/>
      <TfrxCheckBoxControl Name="CBPageKrok" Left="12" Top="92" Width="121" Height="17" Caption="Відображати кроки" Checked="True" State="cbChecked" Color="-16777201" OnClick="CBPageKrokOnClick"/>
      <TfrxEditControl Name="EdMejnF" Left="36" Top="144" Width="73" Height="21" Color="-16777211" MaxLength="0" PasswordChar="0" Text="1" OnExit="EdMejnFOnExit"/>
      <TfrxLabelControl Name="Label1" Left="12" Top="120" Width="183" Height="13" Caption="Відображати список межових знаків" Color="-16777201"/>
      <TfrxLabelControl Name="Label2" Left="12" Top="148" Width="15" Height="13" Caption="від" Color="-16777201"/>
      <TfrxEditControl Name="EdMejnL" Left="140" Top="144" Width="73" Height="21" Color="-16777211" MaxLength="0" PasswordChar="0" Text="Edit1" OnExit="EdMejnLOnExit"/>
      <TfrxLabelControl Name="Label3" Left="120" Top="148" Width="12" Height="13" Caption="по" Color="-16777201"/>
    </TfrxGroupBoxControl>
    <TfrxGroupBoxControl Name="GroupBox2" Left="244" Top="4" Width="265" Height="101" Caption=" Власники / користувачі " Color="-16777201">
      <TfrxRadioButtonControl Name="RBUsers1" Left="12" Top="20" Width="69" Height="17" Caption="Власники" Checked="True" Color="-16777201" OnClick="RBUsers1OnClick"/>
      <TfrxRadioButtonControl Name="RBUsers2" Left="116" Top="20" Width="85" Height="17" Caption="Користувачі" Color="-16777201" OnClick="RBUsers2OnClick"/>
      <TfrxCheckBoxControl Name="CheckBox1" Left="12" Top="44" Width="113" Height="17" Caption="Хтось один з них:" Color="-16777201" OnClick="CheckBox1OnClick"/>
      <TfrxComboBoxControl Name="CBUsersL" Left="12" Top="68" Width="240" Height="20" Enabled="False" Color="-16777211" Items.Text="" Style="csDropDownList" ItemIndex="-1"/>
    </TfrxGroupBoxControl>
    <TfrxGroupBoxControl Name="GroupBox3" Left="244" Top="108" Width="265" Height="152" Caption=" Додатково " Color="-16777201">
      <TfrxLabelControl Name="Label4" Left="12" Top="20" Width="203" Height="13" Caption="Масштаб для малюнка межового знака:" Color="-16777201"/>
      <TfrxComboBoxControl Name="LDScale" Left="32" Top="40" Width="77" Height="21" Color="-16777211" Items.Text="1&#13;&#10;10&#13;&#10;15&#13;&#10;20&#13;&#10;25&#13;&#10;50&#13;&#10;40&#13;&#10;75&#13;&#10;100&#13;&#10;200&#13;&#10;400&#13;&#10;500&#13;&#10;800&#13;&#10;1000&#13;&#10;2000&#13;&#10;2500&#13;&#10;5000&#13;&#10;10000&#13;&#10;15000&#13;&#10;25000&#13;&#10;30000&#13;&#10;40000&#13;&#10;50000&#13;&#10;75000&#13;&#10;100000&#13;&#10;150000&#13;&#10;200000&#13;&#10;300000&#13;&#10;500000&#13;&#10;1000000&#13;&#10;3000000&#13;&#10;5000000&#13;&#10;10000000" Text="200" ItemIndex="-1" OnEnter="LDScaleOnEnter"/>
      <TfrxLabelControl Name="Label7" Left="12" Top="44" Width="16" Height="13" Caption="1 : " Color="-16777201"/>
      <TfrxCheckBoxControl Name="CBVisKoord" Left="12" Top="72" Width="233" Height="17" Caption="Відображати координати межових знаків" Checked="True" State="cbChecked" Color="-16777201"/>
      <TfrxCheckBoxControl Name="CBDlineMejn" Left="12" Top="96" Width="233" Height="17" Caption="Визначати відстані між ближніми знаками" Color="-16777201"/>
      <TfrxCheckBoxControl Name="CBPodpsSmj" Left="12" Top="120" Width="189" Height="17" Caption="Відображати підписи суміжників" Checked="True" State="cbChecked" Color="-16777201"/>
    </TfrxGroupBoxControl>
  </TfrxDialogPage>
  <TfrxReportPage Name="PageAkt" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="20" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxMasterData Name="MainMD" Height="154,96073" Left="0" Top="18,89765" Width="680,3154" ColumnWidth="0" ColumnGap="0" PrintIfDetailEmpty="True" RowCount="1" StartNewPage="True" Stretched="True">
      <TfrxMemoView Name="Memo1" Align="baCenter" Left="34,01577" Top="0" Width="612,28386" Height="52,91342" Font.Charset="1" Font.Color="-16777208" Font.Height="-21" Font.Name="Times New Roman" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="Р’Р†Р”РћРњРћРЎРўР†&#13;&#10;РїСЂРѕ РІСЃС‚Р°РЅРѕРІР»РµРЅС– РјРµР¶РѕРІС– Р·РЅР°РєРё"/>
      <TfrxMemoView Name="Memo2" Left="400,63018" Top="71,81107" Width="279,68522" Height="22,67718" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" HAlign="haRight" ParentFont="False" Text="&#34;___&#34; ______________ 20___ СЂРѕРєСѓ"/>
      <TfrxMemoView Name="Memo3" Left="0" Top="71,81107" Width="241,88992" Height="22,67718" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="4" HAlign="haCenter" ParentFont="False" Text="[AktCity]"/>
      <TfrxMemoView Name="Memo4" Left="0" Top="117,16543" Width="291,02381" Height="18,89765" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" ParagraphGap="40" ParentFont="False" Text="РњРё, С‰Рѕ РЅРёР¶С‡Рµ РїС–РґРїРёСЃР°Р»РёСЃСЏ:"/>
      <TfrxMemoView Name="Memo5" Left="0" Top="136,06308" Width="680,3154" Height="18,89765" StretchMode="smActualHeight" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" ParagraphGap="40" ParentFont="False" Text="1. РџСЂРµРґСЃС‚Р°РІРЅРёРє &#60;b&#62;[IspNameKogo] РІ РѕСЃРѕР±С– [ShortFamily(IspPreds)]&#60;/b&#62;, РЅР°РґР°Р»С– &#60;b&#62;Р’РёРєРѕРЅР°РІРµС†СЊ&#60;/b&#62;,"/>
      <TfrxMemoView Name="Memo7" Left="653,85869" Top="0" Width="22,67718" Height="18,89765" Font.Charset="1" Font.Color="-16777208" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" Text="21"/>
    </TfrxMasterData>
    <TfrxDetailData Name="DDUsers" Height="18,89765" Left="0" Top="196,53556" Width="680,3154" OnBeforePrint="DDUsersOnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="ListUsers" DataSetName="ListUsers" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo6" Left="0" Top="0" Width="680,3154" Height="18,89765" StretchMode="smActualHeight" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" ParagraphGap="40" ParentFont="False" Text="[NomVl]. [NameUser],"/>
    </TfrxDetailData>
    <TfrxDetailData Name="SmejHead" Height="18,89765" Left="0" Top="238,11039" Width="680,3154" OnBeforePrint="SmejHeadOnBeforePrint" ColumnWidth="0" ColumnGap="0" RowCount="1">
      <TfrxMemoView Name="Memo8" Left="0" Top="0" Width="680,3154" Height="18,89765" StretchMode="smActualHeight" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" Text="Сѓ РїСЂРёСЃСѓС‚РЅРѕСЃС‚С– РІР»Р°СЃРЅРёРєС–РІ (РєРѕСЂРёСЃС‚СѓРІР°С‡С–РІ) СЃСѓРјС–Р¶РЅРёС… Р·РµРјРµР»СЊРЅРёС… РґС–Р»СЏРЅРѕРє:"/>
    </TfrxDetailData>
    <TfrxADOQuery Name="OpisSmej" UserName="OpisSmej" CloseDataSource="True" FieldAliases.Text="" SQL.Text="" CommandTimeout="30" PropData="0A506172616D65746572730100"/>
    <TfrxDetailData Name="SmejnDD" Height="18,89765" Left="0" Top="279,68522" Width="680,3154" OnBeforePrint="SmejnDDOnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="OpisSmej" DataSetName="OpisSmej" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo9" Left="0" Top="0" Width="680,3154" Height="18,89765" StretchMode="smActualHeight" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" ParagraphGap="40" ParentFont="False" Text="[NomVl]. [NameSmejn]"/>
    </TfrxDetailData>
    <TfrxDetailData Name="DetailData3" Height="272,12616" Left="0" Top="321,26005" Width="680,3154" AllowSplit="True" ColumnWidth="0" ColumnGap="0" RowCount="1" Stretched="True">
      <TfrxMemoView Name="Memo10" Left="0" Top="0" Width="680,3154" Height="22,67718" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" Text="СЃРєР»Р°Р»Рё С†РµР№ Р°РєС‚ РїСЂРѕ С‚Р°РєРµ:"/>
      <TfrxMemoView Name="Memo11" Left="3,77953" Top="22,67718" Width="680,3154" Height="245,66945" StretchMode="smActualHeight" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" ParagraphGap="40" ParentFont="False" Text="РЈ РІС–РґРїРѕРІС–РґРЅРѕСЃС‚С– РґРѕ СЃС‚. 106 Р—РµРјРµР»СЊРЅРѕРіРѕ РєРѕРґРµРєСЃСѓ РЈРєСЂР°С—РЅРё : РјРµР¶РѕРІРёРјРё Р·РЅР°РєР°РјРё РјРѕР¶СѓС‚СЊ Р±СѓС‚Рё РїСЂРёСЂРѕРґРЅС– С‡Рё С€С‚СѓС‡РЅС– СЃРїРѕСЂСѓРґРё С– СЂСѓР±РµР¶С– (СЂС–С‡РєРё, СЃС‚СЂСѓРјРєРё, РєР°РЅР°Р»Рё, Р»С–СЃРѕСЃРјСѓРіРё, СЂРѕСЃР»РёРЅРЅС– СЃРјСѓРіРё, РґРµСЂРµРІР°, СЃС‚РµР¶РєРё, СЂС–РІС‡Р°РєРё, СЃС‚С–РЅРё, РїР°СЂРєР°РЅРё, РѕРіРѕСЂРѕР¶Р°, С€Р»СЏС…РѕРІС– СЃРїРѕСЂСѓРґРё, Р±РµС‚РѕРЅРЅС– Р°Р±Рѕ РјРµС‚Р°Р»РµРІС– СЃС‚РѕРІРїРё, РїР»РёС‚Рё, РјРѕРЅРѕР»С–С‚Рё, РєР°РјРµРЅС–, С–РЅС€С– СЃРїРѕСЂСѓРґРё С– СЂСѓР±РµР¶С–), С‰Рѕ Р·Р±С–РіР°СЋС‚СЊСЃСЏ С–Р· РјРµР¶РµСЋ Р·РµРјРµР»СЊРЅРѕС— РґС–Р»СЏРЅРєРё Р°Р±Рѕ СЃРїРµС†С–Р°Р»СЊРЅРѕ РІСЃС‚Р°РЅРѕРІР»СЋСЋС‚СЊСЃСЏ РЅР° РЅС–Р№. РЈ СЂР°Р·С– СЏРєС‰Рѕ РјРµР¶С– Р·РµРјРµР»СЊРЅРёС… РґС–Р»СЏРЅРѕРє Сѓ РЅР°С‚СѓСЂС– (РЅР° РјС–СЃС†РµРІРѕСЃС‚С–) Р·Р±С–РіР°СЋС‚СЊСЃСЏ Р· РїСЂРёСЂРѕРґРЅРёРјРё С‡Рё С€С‚СѓС‡РЅРёРјРё Р»С–РЅС–Р№РЅРёРјРё СЃРїРѕСЂСѓРґР°РјРё, СЂСѓР±РµР¶Р°РјРё (СЂС–С‡РєР°РјРё, СЃС‚СЂСѓРјРєР°РјРё, РєР°РЅР°Р»Р°РјРё, Р»С–СЃРѕСЃРјСѓРіР°РјРё, СЂРѕСЃР»РёРЅРЅРёРјРё СЃРјСѓРіР°РјРё, С€Р»СЏС…Р°РјРё, СЃС‚РµР¶РєР°РјРё, СЂС–РІС‡Р°РєР°РјРё, СЃС‚С–РЅР°РјРё, С€Р»СЏС…РѕРІРёРјРё СЃРїРѕСЂСѓРґР°РјРё, РїР°СЂРєР°РЅР°РјРё, РѕРіРѕСЂРѕР¶РµСЋ, С„Р°СЃР°РґР°РјРё Р±СѓРґС–РІРµР»СЊ, С–РЅС€РёРјРё Р»С–РЅС–Р№РЅРёРјРё СЃРїРѕСЂСѓРґР°РјРё, СЂСѓР±РµР¶Р°РјРё С‚РѕС‰Рѕ) С‚Р° СЂР°РЅС–С€Рµ РІСЃС‚Р°РЅРѕРІР»РµРЅРёРјРё РјРµР¶Р°РјРё СЃС„РѕСЂРјРѕРІР°РЅРёС… Р·РµРјРµР»СЊРЅРёС… РґС–Р»СЏРЅРѕРє, РјРµР¶РѕРІС– Р·РЅР°РєРё РјРѕР¶СѓС‚СЊ РЅРµ РІСЃС‚Р°РЅРѕРІР»СЋРІР°С‚РёСЃСЏ, Р° С‚Р°РєРѕР¶ РІС–РґРїРѕРІС–РґРЅРѕ РґРѕ:&#13;&#10;- Рї.9 РџРµСЂРµС…С–РґРЅРёС… РїРѕР»РѕР¶РµРЅСЊ Р—РµРјРµР»СЊРЅРѕРіРѕ РєРѕРґРµРєСЃСѓ РЈРєСЂР°С—РЅРё;&#13;&#10;- СЃС‚.50, СЃС‚.55 Р—Р°РєРѕРЅСѓ &#34;РџСЂРѕ Р·РµРјР»РµСѓСЃС‚СЂС–Р№&#34;;&#13;&#10;РјРµР¶С– РґР°РЅРёС… Р·РµРјРµР»СЊРЅРѕС— РґС–Р»СЏРЅРєРё РЅРµ РїРѕРіРѕРґР¶СѓРІР°Р»РёСЃСЊ."/>
    </TfrxDetailData>
    <TfrxADOQuery Name="ListArend" UserName="ListArend" CloseDataSource="True" FieldAliases.Text="" SQL.Text="" CommandTimeout="30" PropData="0A506172616D65746572730100"/>
    <TfrxADOQuery Name="ListUsers" UserName="ListUsers" CloseDataSource="True" FieldAliases.Text="" SQL.Text="" CommandTimeout="30" PropData="0A506172616D65746572730100"/>
    <TfrxADOQuery Name="UserRec" UserName="UserRec" CloseDataSource="True" FieldAliases.Text="" SQL.Text="" CommandTimeout="30" PropData="0A506172616D65746572730100"/>
    <TfrxADOQuery Name="MejnZN" UserName="MejnZN" CloseDataSource="True" FieldAliases.Text="" SQL.Text="" CommandTimeout="30" PropData="0A506172616D65746572730100"/>
    <TfrxDetailData Name="DetailData5" Height="45,35436" Left="0" Top="646,29963" Width="680,3154" ColumnWidth="0" ColumnGap="0" RowCount="1">
      <TfrxMemoView Name="Memo15" Left="3,77953" Top="7,55906" Width="680,3154" Height="37,7953" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" ParagraphGap="40" ParentFont="False" Text="[IIf(ListUsers.RecordCount &#62; 1, IIf(Vladel, '&#60;u&#62;Р’Р»Р°СЃРЅРёРєРё&#60;/u&#62;/РєРѕСЂРёСЃС‚СѓРІР°С‡С–', 'Р’Р»Р°СЃРЅРёРєРё/&#60;u&#62;РєРѕСЂРёСЃС‚СѓРІР°С‡С–&#60;/u&#62;'), IIf(Vladel, '&#60;u&#62;Р’Р»Р°СЃРЅРёРє&#60;/u&#62;/РєРѕСЂРёСЃС‚СѓРІР°С‡', 'Р’Р»Р°СЃРЅРёРє/&#60;u&#62;РєРѕСЂРёСЃС‚СѓРІР°С‡&#60;/u&#62;'))]&#13;&#10;Р·РµРјРµР»СЊРЅРѕС— РґС–Р»СЏРЅРєРё"/>
    </TfrxDetailData>
    <TfrxSubdetailData Name="SubdetailData1" Height="34,01577" Left="0" Top="714,33117" Width="680,3154" OnBeforePrint="SubdetailData1OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="ListUsers" DataSetName="ListUsers" RowCount="0">
      <TfrxMemoView Name="Memo14" Left="449,76407" Top="0" Width="230,55133" Height="18,89765" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="8" HAlign="haCenter" ParentFont="False" Text="[ShortFamily(NameUser)]"/>
      <TfrxMemoView Name="Memo16" Left="279,68522" Top="0" Width="113,3859" Height="18,89765" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="8" HAlign="haCenter" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo17" Left="279,68522" Top="18,89765" Width="113,3859" Height="15,11812" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="(РїС–РґРїРёСЃ)"/>
    </TfrxSubdetailData>
    <TfrxDetailData Name="DetailData6" Height="52,91342" Left="0" Top="771,02412" Width="680,3154" ColumnWidth="0" ColumnGap="0" RowCount="1">
      <TfrxMemoView Name="Memo18" Left="442,20501" Top="15,11812" Width="230,55133" Height="18,89765" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="8" HAlign="haCenter" ParentFont="False" Text="[ShortFamily(IspPreds)]"/>
      <TfrxMemoView Name="Memo19" Left="279,68522" Top="11,33859" Width="113,3859" Height="18,89765" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="8" HAlign="haCenter" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo21" Left="0" Top="11,33859" Width="264,5671" Height="18,89765" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" Text="Р’РёРєРѕРЅР°РІРµС†СЊ СЂРѕР±С–С‚"/>
      <TfrxMemoView Name="Memo25" Left="279,68522" Top="30,23624" Width="113,3859" Height="15,11812" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="(РїС–РґРїРёСЃ)"/>
    </TfrxDetailData>
    <TfrxDetailData Name="DetailData1" Height="7,55906" Left="0" Top="616,06339" Width="680,3154" ColumnWidth="0" ColumnGap="0" RowCount="1"/>
    <TfrxADOQuery Name="MejnSlave" UserName="MejnSlave" CloseDataSource="True" FieldAliases.Text="" SQL.Text="" CommandTimeout="30" PropData="0A506172616D65746572730100"/>
    <TfrxADOQuery Name="Points" UserName="Points" CloseDataSource="True" FieldAliases.Text="" SQL.Text="" CommandTimeout="30" PropData="0A506172616D65746572730100"/>
  </TfrxReportPage>
  <TfrxReportPage Name="PageAbris" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="20" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxDetailData Name="DDPicture" Height="434,64595" Left="0" Top="188,9765" Width="680,3154" ColumnWidth="0" ColumnGap="0" RowCount="1">
      <TfrxPictureView Name="Picture1" Left="0" Top="26,45671" Width="680,3154" Height="359,05535" OnBeforePrint="Picture1OnBeforePrint" KeepAspectRatio="False" Stretched="False"/>
    </TfrxDetailData>
    <TfrxHeader Name="DDOpisSmH" Height="30,23624" Left="0" Top="646,29963" Width="680,3154">
      <TfrxMemoView Name="Memo29" Left="0" Top="11,33859" Width="264,5671" Height="18,89765" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" Text="РћРџРРЎ РњР•Р–:"/>
    </TfrxHeader>
    <TfrxDetailData Name="DDOpisSm" Height="22,67718" Left="0" Top="699,21305" Width="680,3154" OnBeforePrint="DDOpisSmOnBeforePrint" AllowSplit="True" ColumnWidth="0" ColumnGap="0" RowCount="1" Stretched="True">
      <TfrxMemoView Name="Memo30" Left="0" Top="3,77953" Width="680,3154" Height="18,89765" StretchMode="smActualHeight" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" LineSpacing="4" ParentFont="False" Text="[OpisSmejn]"/>
    </TfrxDetailData>
    <TfrxDetailData Name="Abris2" Height="147,40167" Left="0" Top="744,56741" Width="680,3154" ColumnWidth="0" ColumnGap="0" RowCount="1">
      <TfrxMemoView Name="Memo31" Left="0" Top="71,81107" Width="264,5671" Height="18,89765" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" Text="РђР±СЂРёСЃ СЃРєР»Р°РІ:"/>
      <TfrxMemoView Name="Memo32" Left="0" Top="41,57483" Width="680,3154" Height="22,67718" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo34" Left="226,7718" Top="75,5906" Width="219,21274" Height="22,67718" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="________________________"/>
      <TfrxMemoView Name="Memo35" Left="226,7718" Top="94,48825" Width="219,21274" Height="15,11812" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="(РїС–РґРїРёСЃ)"/>
      <TfrxMemoView Name="Memo36" Left="449,76407" Top="75,5906" Width="226,7718" Height="22,67718" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="4" HAlign="haCenter" ParentFont="False" Text="[ShortFamily(IspPreds)]"/>
    </TfrxDetailData>
    <TfrxMasterData Name="MasterData3" Height="147,40167" Left="0" Top="18,89765" Width="680,3154" ColumnWidth="0" ColumnGap="0" RowCount="1" Stretched="True">
      <TfrxMemoView Name="Memo12" Align="baCenter" Left="207,87415" Top="15,1181200000001" Width="264,5671" Height="45,35436" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="&#60;b&#62;РђР‘Р РРЎ&#60;/b&#62;&#13;&#10;Р·РµРјРµР»СЊРЅРѕС— РґС–Р»СЏРЅРєРё"/>
      <TfrxMemoView Name="Memo13" Left="0" Top="86,92919" Width="680,3154" Height="60,47248" StretchMode="smActualHeight" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" Text="РќР°Р·РІР° РѕР±вЂ™С”РєС‚Р° (РџР†Р‘ Р·Р°РјРѕРІРЅРёРєР°): &#60;u&#62;[NameUsers2]&#60;/u&#62;&#13;&#10;РђРґСЂРµСЃР° Р·РµРјРµР»СЊРЅРѕС— РґС–Р»СЏРЅРєРё: &#60;u&#62;[ObjAddress2]&#60;/u&#62;"/>
      <TfrxMemoView Name="Memo20" Left="653,85869" Top="0" Width="22,67718" Height="18,89765" Font.Charset="1" Font.Color="-16777208" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" Text="22"/>
    </TfrxMasterData>
  </TfrxReportPage>
  <TfrxReportPage Name="PageSpMejn" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="20" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxHeader Name="Header2" Height="132,28355" Left="0" Top="18,89765" Width="680,3154">
      <TfrxMemoView Name="Memo38" Align="baCenter" Left="128,50402" Top="11,33859" Width="423,30736" Height="49,13389" Font.Charset="1" Font.Color="-16777208" Font.Height="-21" Font.Name="Times New Roman" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="РЎРџРРЎРћРљ&#13;&#10;РјРµР¶РѕРІРёС… Р·РЅР°РєС–РІ, РїРµСЂРµРґР°РЅРёС… РЅР° Р·Р±РµСЂС–РіР°РЅРЅСЏ"/>
      <TfrxMemoView Name="Memo40" Left="3,77953" Top="90,70872" Width="37,7953" Height="41,57483" Font.Charset="1" Font.Color="-16777208" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="N&#13;&#10;Р·/Рї"/>
      <TfrxMemoView Name="Memo41" Left="41,57483" Top="90,70872" Width="200,31509" Height="41,57483" Font.Charset="1" Font.Color="-16777208" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РќРѕРјРµСЂ Р·РЅР°РєР°"/>
      <TfrxMemoView Name="Memo42" Left="241,88992" Top="90,70872" Width="434,64595" Height="41,57483" Font.Charset="1" Font.Color="-16777208" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РђР±СЂРёСЃ С‚Р° РѕРїРёСЃ РјС–СЃС†РµР·РЅР°С…РѕРґР¶РµРЅРЅСЏ РјРµР¶РѕРІРѕРіРѕ Р·РЅР°РєР°"/>
      <TfrxMemoView Name="Memo22" Left="653,85869" Top="0" Width="22,67718" Height="18,89765" Font.Charset="1" Font.Color="-16777208" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" Text="23"/>
    </TfrxHeader>
    <TfrxFooter Name="Footer1" Height="64,25201" Left="0" Top="302,3624" Width="680,3154">
      <TfrxMemoView Name="Memo46" Left="7,55906" Top="26,45671" Width="94,48825" Height="18,89765" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" Text="Р—РґР°РІ"/>
      <TfrxMemoView Name="Memo49" Left="347,71676" Top="26,45671" Width="94,48825" Height="18,89765" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" Text="РџСЂРёР№РЅСЏРІ"/>
    </TfrxFooter>
    <TfrxMasterData Name="MasterData2" Height="105,82684" Left="0" Top="173,85838" Width="680,3154" OnBeforePrint="MasterData2OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="MejnZN" DataSetName="MejnZN" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo43" Left="3,77953" Top="0" Width="37,7953" Height="105,82684" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" GapX="4" GapY="3" HAlign="haCenter" ParentFont="False" Text="[LineMejnNumb]"/>
      <TfrxMemoView Name="Memo44" Left="41,57483" Top="0" Width="200,31509" Height="105,82684" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" GapX="4" GapY="3" HAlign="haCenter" ParentFont="False" Text="[EditMarkNomb(&#60;MejnZN.&#34;MarkNumber&#34;&#62;)]"/>
      <TfrxMemoView Name="Memo45" Left="377,953" Top="0" Width="298,58287" Height="105,82684" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="14" GapX="6" GapY="3" ParentFont="False" Text="[MarkNote]"/>
      <TfrxPictureView Name="Picture2" Left="241,88992" Top="0" Width="136,06308" Height="105,82684" KeepAspectRatio="False" Stretched="False"/>
      <TfrxMemoView Name="Memo23" Left="241,88992" Top="0" Width="136,06308" Height="105,82684" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="13" GapX="6" GapY="3" ParentFont="False" Text=""/>
    </TfrxMasterData>
    <TfrxMasterData Name="ListUsPidp3" Height="41,57483" Left="0" Top="389,29159" Width="680,3154" OnBeforePrint="ListUsPidp3OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="ListUsers" DataSetName="ListUsers" RowCount="0">
      <TfrxMemoView Name="IspPidps1" Left="11,33859" Top="22,67718" Width="120,94496" Height="18,89765" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="4" HAlign="haCenter" ParentFont="False" Text="(РїС–РґРїРёСЃ)"/>
      <TfrxMemoView Name="IspPidps2" Left="154,96073" Top="0" Width="170,07885" Height="22,67718" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="8" HAlign="haCenter" ParentFont="False" Text="[ShortFamily(IspPreds)]"/>
      <TfrxMemoView Name="Memo50" Left="351,49629" Top="22,67718" Width="120,94496" Height="18,89765" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="4" HAlign="haCenter" ParentFont="False" Text="(РїС–РґРїРёСЃ)"/>
      <TfrxMemoView Name="Memo51" Left="495,11843" Top="0" Width="170,07885" Height="22,67718" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="8" HAlign="haCenter" ParentFont="False" Text="[ShortFamily(NameUser)]"/>
    </TfrxMasterData>
  </TfrxReportPage>
  <TfrxReportPage Name="PageKrok" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="20" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxFooter Name="Footer2" Height="0" Left="0" Top="291,02381" Width="680,3154" OnAfterPrint="Footer2OnAfterPrint"/>
    <TfrxPageFooter Name="FooterStep" Height="52,91342" Left="0" Top="351,49629" Width="680,3154">
      <TfrxMemoView Name="Memo57" Left="3,77953" Top="15,11812" Width="52,91342" Height="22,67718" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" Text="РЎРєР»Р°РІ"/>
      <TfrxMemoView Name="Memo58" Left="56,69295" Top="15,11812" Width="619,84292" Height="18,89765" StretchMode="smActualHeight" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="8" ParentFont="False" Text="                         [ShortFamily(IspPreds)]"/>
      <TfrxMemoView Name="Memo59" Left="56,69295" Top="34,01577" Width="619,84292" Height="18,89765" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="(РїРѕСЃР°РґР°, РїС–РґРїРёСЃ, С–РЅС–С†С–Р°Р»Рё С‚Р° РїСЂС–Р·РІРёС‰Рµ)"/>
    </TfrxPageFooter>
    <TfrxChild Name="Child1" Height="64,25201" Left="0" Top="124,72449" Width="680,3154" Child="Child2" KeepChild="True" Stretched="True">
      <TfrxMemoView Name="Memo62" Left="0" Top="0" Width="680,3154" Height="60,47248" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-16777208" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="3" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo55" Left="7,55906" Top="0" Width="355,27582" Height="60,47248" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" GapX="5" ParentFont="False" Text="[MarkOpis]"/>
      <TfrxMemoView Name="Memo56" Left="362,83488" Top="0" Width="309,92146" Height="60,47248" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="Р’РёРґРёРјС–СЃС‚СЊ РЅР° СЃСѓРјС–Р¶РЅС– РјРµР¶РѕРІС– Р·РЅР°РєРё"/>
    </TfrxChild>
    <TfrxChild Name="Child2" Height="7,55906" Left="0" Top="211,65368" Width="680,3154" Child="Child3">
      <TfrxMemoView Name="Memo63" Left="0" Top="0" Width="680,3154" Height="7,55906" Font.Charset="1" Font.Color="-16777208" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="11" ParentFont="False" Text=""/>
    </TfrxChild>
    <TfrxMasterData Name="MasterData1" Height="83,14966" Left="0" Top="18,89765" Width="680,3154" OnBeforePrint="MasterData1OnBeforePrint" Child="Child1" ColumnWidth="0" ColumnGap="0" DataSet="MejnZN" DataSetName="MejnZN" KeepChild="True" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo61" Left="0" Top="0" Width="680,3154" Height="83,14966" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-16777208" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="7" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo47" Align="baCenter" Left="69,921305" Top="0" Width="540,47279" Height="26,45671" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-21" Font.Name="Times New Roman" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="РљСЂРѕРєРё РјРµР¶РѕРІРѕРіРѕ Р·РЅР°РєР° в„– &#60;u&#62;[EditMarkNomb(&#60;MejnZN.&#34;MarkNumber&#34;&#62;)]&#60;/u&#62;"/>
      <TfrxMemoView Name="Memo52" Left="0" Top="26,45671" Width="672,75634" Height="26,45671" StretchMode="smActualHeight" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" Text="Р’РёРєРѕРЅР°РІРµС†СЊ СЂРѕР±С–С‚ &#60;u&#62;[IspNameKto]&#60;/u&#62;"/>
      <TfrxMemoView Name="Memo53" Left="7,55906" Top="49,13389" Width="355,27582" Height="22,67718" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" GapX="5" ParentFont="False" Text="[MarkNote]"/>
      <TfrxMemoView Name="Memo54" Left="362,83488" Top="49,13389" Width="309,92146" Height="22,67718" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="РћРїРёСЃ РјС–СЃС†РµР·РЅР°С…РѕРґР¶РµРЅРЅСЏ"/>
    </TfrxMasterData>
    <TfrxChild Name="Child3" Height="26,45671" Left="0" Top="241,88992" Width="680,3154" OnBeforePrint="Child3OnBeforePrint"/>
  </TfrxReportPage>
</TfrxReport>
