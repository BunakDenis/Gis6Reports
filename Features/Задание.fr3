<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="3.24" DotMatrixReport="False" EngineOptions.MaxMemSize="2000" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="За замовчуванням" ReportOptions.CreateDate="41474,3966252431" ReportOptions.Description.Text="" ReportOptions.LastChange="45546,990749838" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;  ID_Objects, Otveden, NameKtoSkr, NameKomu, ListFirm, ListPeople, AdrObj, NaznFunk, ListNaznF,&#13;&#10;  KatZeml, ListKatZ, Teritor, SilRad, ObmN, ServN, DocPrav, Pidps, IspName, IspDir : string;&#13;&#10;&#13;&#10;  LeaseN : boolean;&#13;&#10;&#13;&#10;  iUser : integer;&#13;&#10;&#13;&#10;  ID, SumArea : double;&#13;&#10;&#13;&#10;procedure UsrDataOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  If Pos(', ', NameKtoSkr) &#62; 0 then&#13;&#10;  begin&#13;&#10;    Pidps      := Copy(NameKtoSkr, 1, Pos(', ', NameKtoSkr) - 1);&#13;&#10;    NameKtoSkr := Copy(NameKtoSkr, Pos(', ', NameKtoSkr) + 2, Length(NameKtoSkr));&#13;&#10;  end&#13;&#10;  else&#13;&#10;    Pidps := NameKtoSkr;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;  //------------------------------------------------------------------------------------------------&#13;&#10;  // Техническая документация&#13;&#10;&#13;&#10;  IspName := ''; //Название исполнителя (кому?)&#13;&#10;  IspDir  := ''; //Директор исполнителя&#13;&#10;&#13;&#10;  If RecordCount('DM1.QiTechDoc') &#62; 0 Then&#13;&#10;  begin&#13;&#10;    If LocateData('DM1.QsFirm', 'ID_Firm', &#60;DM1.QiTechDoc.&#34;ID_Firm&#34;&#62;) Then&#13;&#10;    begin&#13;&#10;      IspName := &#60;DM1.QsFirm.&#34;Name_Small&#34;&#62;;&#13;&#10;&#13;&#10;      If LocateData('DM1.QsPeople', 'ID_People', &#60;DM1.QsFirm.&#34;ID_People&#34;&#62;) then&#13;&#10;         IspDir := &#60;DM1.QsPeople.&#34;Family&#34;&#62;;&#13;&#10;    end;&#13;&#10;  end;&#13;&#10;&#13;&#10;  If Length(IspName) = 0 then&#13;&#10;    IspName := Firm_Small;&#13;&#10;  If Length(IspDir) = 0 then&#13;&#10;    IspDir := BossFio;&#13;&#10;&#13;&#10;  //------------------------------------------------------------------------------------------------&#13;&#10;  // Глобальные переменные&#13;&#10;&#13;&#10;  NameKtoSkr := ''; //Владелец/пользователь сокращено (кто?)&#13;&#10;  NameKomu   := ''; //Владелец/пользователь (кто?)&#13;&#10;  iUser      := 0; //Количество владельцев/пользователь&#13;&#10;&#13;&#10;  AdrObj     := ''; //Адрес участка&#13;&#10;  SumArea    := 0; //Общая площадь участков&#13;&#10;  KatZeml    := ''; //Категория земель участков&#13;&#10;&#13;&#10;  //------------------------------------------------------------------------------------------------&#13;&#10;  // Отбор отмеченных участков&#13;&#10;&#13;&#10;  ID_Objects := ''; //Перечень кодов отмеченных участков&#13;&#10;&#13;&#10;  //Создаём фильтр и сохраняем текущий указатель&#13;&#10;  ID := &#60;DM1.QbObject.&#34;ID_Object&#34;&#62;;&#13;&#10;  FilterData('DM1.QbObject', 'Ok = ''ю''');&#13;&#10;&#13;&#10;  DataFirst('DM1.QbObject');&#13;&#10;&#13;&#10;  //--------------------------&#13;&#10;  // Територия земель&#13;&#10;&#13;&#10;  Teritor := '';&#13;&#10;  SilRad  := '';&#13;&#10;&#13;&#10;  //Совет&#13;&#10;  If Length(Name_Advice) &#62; 0 then&#13;&#10;  begin&#13;&#10;     If Pos('ька ', Name_Advice) &#62; 0 then&#13;&#10;       If Pos('сільська', Name_Advice) &#62; 0 then&#13;&#10;         Teritor := Teritor + Copy(Name_Advice, 1, Pos('ька ', Name_Advice)) + 'кої сільської ради '&#13;&#10;       else&#13;&#10;         If Pos('міська', Name_Advice) &#62; 0 then&#13;&#10;           Teritor := Teritor + Copy(Name_Advice, 1, Pos('ька ', Name_Advice)) + 'кої міської ради '&#13;&#10;         else&#13;&#10;           Teritor := Teritor + Name_Advice + ' '&#13;&#10;     else&#13;&#10;       Teritor := Teritor + Name_Advice + ' ';&#13;&#10;  end;&#13;&#10;&#13;&#10;  SilRad := Trim(Teritor);&#13;&#10;&#13;&#10;  //Район&#13;&#10;  If Length(Name_Region) &#62; 0 then&#13;&#10;  begin&#13;&#10;     If Pos('ький ', Name_Region) &#62; 0 then&#13;&#10;       Teritor := Teritor + Copy(Name_Region, 1, Pos('ький ', Name_Region)) + 'кого району '&#13;&#10;     else&#13;&#10;       If Pos('ний ', Name_Region) &#62; 0 then&#13;&#10;         Teritor := Teritor + Copy(Name_Region, 1, Pos('ний ', Name_Region)) + 'ного району '&#13;&#10;       else&#13;&#10;         Teritor := Teritor + Name_Region + ' ';&#13;&#10;  end;&#13;&#10;&#13;&#10;  //Область&#13;&#10;  If LENGTH(Name_Area) &#62; 0 then&#13;&#10;  begin&#13;&#10;    If Pos('ька ', Name_Area) &#62; 0 then&#13;&#10;      Teritor := Teritor + Copy(Name_Area, 1, Pos('ька ', Name_Area)) + 'кої області '&#13;&#10;    else&#13;&#10;      Teritor := Teritor + Name_Area + ' ';&#13;&#10;  end;&#13;&#10;&#13;&#10;  //Удаление запятой с пробелом в конце строки&#13;&#10;  If Length(Trim(Teritor)) &#62; 1 then&#13;&#10;    Teritor := Copy(Teritor, 1, LENGTH(Teritor)-1);&#13;&#10;&#13;&#10;  While not DataEOF('DM1.QbObject') do //Перебираем список отмеченных земельных участков&#13;&#10;  begin&#13;&#10;     ID_Objects := ID_Objects + IntToStr(&#60;DM1.QbObject.&#34;ID_Object&#34;&#62;) + ', ';&#13;&#10;&#13;&#10;     //--------------------------&#13;&#10;     // Участок&#13;&#10;&#13;&#10;     If Pos(Trim(&#60;DM1.QbObject.&#34;Address&#34;&#62;) + ' та ', AdrObj) = 0 then&#13;&#10;       AdrObj := AdrObj + Trim(&#60;DM1.QbObject.&#34;Address&#34;&#62;) + ' та ';&#13;&#10;&#13;&#10;     SumArea  := SumArea + &#60;DM1.QbObject.&#34;Area&#34;&#62;;&#13;&#10;&#13;&#10;     If (LocateData( 'DM2.TbTypeGround', 'ID_TypeGround', &#60;DM1.QbObject.&#34;ID_TypeGround&#34;&#62;)) and&#13;&#10;        (Pos(IntToStr(&#60;DM1.QbObject.&#34;ID_TypeGround&#34;&#62;) + ', ', ListKatZ) = 0) Then&#13;&#10;     begin&#13;&#10;      If Pos('емлі ', Trim(&#60;DM2.TbTypeGround.&#34;Name&#34;&#62;)) = 2 then&#13;&#10;        KatZeml := KatZeml + 'земель' + Copy(Trim(&#60;DM2.TbTypeGround.&#34;Name&#34;&#62;), 6, Length(Trim(&#60;DM2.TbTypeGround.&#34;Name&#34;&#62;)) - 5) + ', '&#13;&#10;      else&#13;&#10;        KatZeml := KatZeml + &#60;DM2.TbTypeGround.&#34;Name&#34;&#62; + ', ';&#13;&#10;&#13;&#10;      ListKatZ := ListKatZ + IntToStr(&#60;DM1.QbObject.&#34;ID_TypeGround&#34;&#62;) + ', ';&#13;&#10;     end;&#13;&#10;&#13;&#10;     //--------------------------&#13;&#10;&#13;&#10;     DataNext('DM1.QbObject');&#13;&#10;  end;&#13;&#10;&#13;&#10;  AdrObj  := Copy(AdrObj, 1, Length(AdrObj) - 4);&#13;&#10;  KatZeml := Copy(KatZeml, 1, Length(KatZeml) - 2);&#13;&#10;&#13;&#10;  ID_Objects := Copy(ID_Objects, 1, Length(ID_Objects) - 2);&#13;&#10;&#13;&#10;  //Скидываем фильтр и устанавливаем указатель на текущий участок&#13;&#10;&#13;&#10;  FilterData('DM1.QbObject', '');&#13;&#10;  LocateData('DM1.QbObject', 'ID_Object', FloatToStr(ID));&#13;&#10;&#13;&#10;  //------------------------------------------------------------------------------------------------&#13;&#10;  // Аренда, пользование&#13;&#10;&#13;&#10;  Otveden    := ''; //Отведено в...&#13;&#10;  ListFirm   := ''; //Перечень уже внесенных организаций&#13;&#10;  ListPeople := ''; //Перечень уже внесенных людей&#13;&#10;  Arenda.SQL.Text := 'SET DATEFORMAT dmy; Select A.* From [Object] O, Lease A, LeasePoly LP ' +&#13;&#10;              'Where (O.ID_Object in (' + Trim(ID_Objects) + ')) And (LP.ID_Object = O.ID_Object) ' +&#13;&#10;              'And (A.ID_Lease = LP.ID_Lease) And (A.DateFirst &#60; GETDATE()) And ' +&#13;&#10;              '((A.DateLast &#62; GETDATE()) or (A.DateLast is Null ))';&#13;&#10;  Arenda.Open;&#13;&#10;&#13;&#10;  If Arenda.RecordCount &#62; 0 then&#13;&#10;  begin&#13;&#10;    LeaseN := true; //Есть аренда или пользование&#13;&#10;&#13;&#10;    Arenda.First;&#13;&#10;&#13;&#10;    Case &#60;Arenda.&#34;ID_TypeLease&#34;&#62; of&#13;&#10;       0 : Otveden := 'в оренду';&#13;&#10;       1 : Otveden := 'в суборенду';&#13;&#10;       2 : Otveden := 'у тимчасове користування';&#13;&#10;       3 : Otveden := 'у тимчасове користування на умовах оренды';&#13;&#10;       4 : Otveden := 'у користування земельною ділянкою для забудови (суперфіцій)';&#13;&#10;       5 : Otveden := 'у користування земельною ділянкою для сільськогосподарського використання (емфітевзис)';&#13;&#10;       6 : Otveden := 'у постійне користування';&#13;&#10;    end;&#13;&#10;&#13;&#10;    While Arenda.EOF = false do //Перебираем список действительных договоров аренды и пользования&#13;&#10;    begin&#13;&#10;      //--------------------------&#13;&#10;      // Пользователи&#13;&#10;&#13;&#10;      If (&#60;Arenda.&#34;ID_LeaserType&#34;&#62; &#60; 3) and (LocateData('DM1.QsPeople', 'ID_People', &#60;Arenda.&#34;ID_LeaserPeople&#34;&#62;) = True)&#13;&#10;                and (Pos(IntToStr(&#60;Arenda.&#34;ID_LeaserPeople&#34;&#62;) + ' ', ListPeople) = 0) Then&#13;&#10;      begin&#13;&#10;        ListPeople := ListPeople + IntToStr(&#60;DM1.QsPeople.&#34;ID_People&#34;&#62;) + ' ';&#13;&#10;        NameKtoSkr := NameKtoSkr + 'гр. ' + FamilyShort(&#60;DM1.QsPeople.&#34;Family&#34;&#62;) + ', ';&#13;&#10;        NameKomu   := NameKomu + 'гр. ' + &#60;DM1.QsPeople.&#34;Family2&#34;&#62; + ', ';&#13;&#10;        iUser      := iUser + 1;&#13;&#10;      end&#13;&#10;      else&#13;&#10;        If (LocateData( 'DM1.QsFirm', 'ID_Firm', &#60;Arenda.&#34;ID_LeaserFirm&#34;&#62;) = True)&#13;&#10;                 and (Pos(IntToStr(&#60;Arenda.&#34;ID_LeaserFirm&#34;&#62;) + ' ', ListFirm) = 0) Then&#13;&#10;        begin&#13;&#10;          ListFirm   := ListFirm + IntToStr(&#60;DM1.QsFirm.&#34;ID_Firm&#34;&#62;) + ' ';&#13;&#10;          NameKomu   := NameKomu + &#60;DM1.QsFirm.&#34;Name_Towhom&#34;&#62; + ', ';&#13;&#10;          iUser      := iUser + 1;&#13;&#10;&#13;&#10;          If LocateData('DM1.QsPeople', 'ID_People', &#60;DM1.QsFirm.&#34;ID_People&#34;&#62;) = True then&#13;&#10;             NameKtoSkr := NameKtoSkr + FamilyShort(&#60;DM1.QsPeople.&#34;Family&#34;&#62;) + ', ';&#13;&#10;        end;&#13;&#10;&#13;&#10;      //Теперь соберём данные по прочим арендаторам&#13;&#10;      Temp.SQL.Text := 'Select * From LeaseUser Where ID_Lease = ' +&#13;&#10;                       IntToStr(&#60;Arenda.&#34;ID_Lease&#34;&#62;) + ' and ID_TypeRecord = 0';&#13;&#10;      Temp.Open;&#13;&#10;&#13;&#10;      If Temp.RecordCount &#62; 0 then&#13;&#10;      begin&#13;&#10;        Temp.First;&#13;&#10;&#13;&#10;        While Temp.EOF = false do //Перебираем список прочих арендаторов&#13;&#10;        begin&#13;&#10;          If (&#60;Temp.&#34;ID_TypeUser&#34;&#62; &#60; 3) and (LocateData('DM1.QsPeople', 'ID_People', &#60;Temp.&#34;ID_People&#34;&#62;) = True)&#13;&#10;                 and (Pos(IntToStr(&#60;Temp.&#34;ID_People&#34;&#62;) + ' ', ListPeople) = 0)  Then&#13;&#10;          begin&#13;&#10;            ListPeople := ListPeople + IntToStr(&#60;DM1.QsPeople.&#34;ID_People&#34;&#62;) + ' ';&#13;&#10;            NameKtoSkr := NameKtoSkr + FamilyShort(&#60;DM1.QsPeople.&#34;Family&#34;&#62;) + ', ';&#13;&#10;            NameKomu   := NameKomu + 'гр. ' + &#60;DM1.QsPeople.&#34;Family2&#34;&#62; + ', ';&#13;&#10;            iUser      := iUser + 1;&#13;&#10;          end&#13;&#10;          else&#13;&#10;            If (LocateData( 'DM1.QsFirm', 'ID_Firm', &#60;Temp.&#34;ID_Firm&#34;&#62;) = True)&#13;&#10;                     and (Pos(IntToStr(&#60;Temp.&#34;ID_Firm&#34;&#62;) + ' ', ListFirm) = 0) Then&#13;&#10;            begin&#13;&#10;              ListFirm   := ListFirm + IntToStr(&#60;DM1.QsFirm.&#34;ID_Firm&#34;&#62;) + ' ';&#13;&#10;              NameKomu   := NameKomu + &#60;DM1.QsFirm.&#34;Name_Towhom&#34;&#62; + ', ';&#13;&#10;              iUser      := iUser + 1;&#13;&#10;&#13;&#10;              If LocateData('DM1.QsPeople', 'ID_People', &#60;DM1.QsFirm.&#34;ID_People&#34;&#62;) = True then&#13;&#10;                 NameKtoSkr := NameKtoSkr + FamilyShort(&#60;DM1.QsPeople.&#34;Family&#34;&#62;) + ', ';&#13;&#10;            end;&#13;&#10;&#13;&#10;          Temp.Next;&#13;&#10;        end;&#13;&#10;      end;&#13;&#10;&#13;&#10;      Temp.Close;&#13;&#10;&#13;&#10;      //--------------------------&#13;&#10;&#13;&#10;      Arenda.Next;&#13;&#10;    end;&#13;&#10;&#13;&#10;    NameKtoSkr := Copy(NameKtoSkr, 1, Length(NameKtoSkr) - 2);&#13;&#10;    NameKomu   := Copy(NameKomu, 1, Length(NameKomu) - 2);&#13;&#10;  end&#13;&#10;  else&#13;&#10;  begin&#13;&#10;    LeaseN  := false; //Собственность&#13;&#10;    Otveden := 'у власність';&#13;&#10;  end;&#13;&#10;&#13;&#10;  //------------------------------------------------------------------------------------------------&#13;&#10;  // Субъекты права&#13;&#10;&#13;&#10;  Users.SQL.Text := 'Select * From UserRec Where (ID_Object in (' +&#13;&#10;                   Trim(ID_Objects) + ')) And (DateFirst &#60;= GETDATE()) And ' +&#13;&#10;                   '(DateLast Is Null Or DateLast &#62; GETDATE()) Order By ID_People, ID_Firm';&#13;&#10;  Users.Open;&#13;&#10;&#13;&#10;  ListFirm   := ''; //Перечень уже внесенных организаций&#13;&#10;  ListPeople := ''; //Перечень уже внесенных людей&#13;&#10;  ListNaznF  := ''; //Перечень уже внесенных функциональных назначений&#13;&#10;  NaznFunk   := ''; //Функциональное назначение&#13;&#10;&#13;&#10;  If LeaseN = false then //Усли нету пользования&#13;&#10;    iUser := 0;&#13;&#10;&#13;&#10;  If Users.RecordCount &#62; 0 then&#13;&#10;  begin&#13;&#10;    Users.First;&#13;&#10;&#13;&#10;    While Users.EOF = false do //Перебираем список субъектов права&#13;&#10;    begin&#13;&#10;      //--------------------------&#13;&#10;      // Владельцы&#13;&#10;&#13;&#10;      If LeaseN = false then&#13;&#10;      begin&#13;&#10;        If (&#60;Users.&#34;ID_TypeOwner&#34;&#62; &#60; 4) and (LocateData('DM1.QsPeople', 'ID_People', &#60;Users.&#34;ID_People&#34;&#62;) = True)&#13;&#10;               and (Pos(IntToStr(&#60;Users.&#34;ID_People&#34;&#62;) + ' ', ListPeople) = 0)  Then&#13;&#10;        begin&#13;&#10;          ListPeople := ListPeople + IntToStr(&#60;DM1.QsPeople.&#34;ID_People&#34;&#62;) + ' ';&#13;&#10;          NameKtoSkr := NameKtoSkr + FamilyShort(&#60;DM1.QsPeople.&#34;Family&#34;&#62;) + ', ';&#13;&#10;          NameKomu   := NameKomu + 'гр. ' + &#60;DM1.QsPeople.&#34;Family2&#34;&#62; + ', ';&#13;&#10;          iUser      := iUser + 1;&#13;&#10;        end&#13;&#10;        else&#13;&#10;          If (LocateData( 'DM1.QsFirm', 'ID_Firm', &#60;Users.&#34;ID_Firm&#34;&#62;) = True)&#13;&#10;                   and (Pos(IntToStr(&#60;Users.&#34;ID_Firm&#34;&#62;) + ' ', ListFirm) = 0) Then&#13;&#10;          begin&#13;&#10;            ListFirm   := ListFirm + IntToStr(&#60;DM1.QsFirm.&#34;ID_Firm&#34;&#62;) + ' ';&#13;&#10;            NameKomu   := NameKomu + &#60;DM1.QsFirm.&#34;Name_Towhom&#34;&#62; + ', ';&#13;&#10;            iUser      := iUser + 1;&#13;&#10;&#13;&#10;            If LocateData('DM1.QsPeople', 'ID_People', &#60;DM1.QsFirm.&#34;ID_People&#34;&#62;) = True then&#13;&#10;               NameKtoSkr := NameKtoSkr + FamilyShort(&#60;DM1.QsPeople.&#34;Family&#34;&#62;) + ', ';&#13;&#10;          end;&#13;&#10;      end;&#13;&#10;&#13;&#10;      //--------------------------&#13;&#10;      // Функциональное назначение&#13;&#10;&#13;&#10;      If LocateData( 'DM2.TbUses', 'ID_Uses', &#60;Users.&#34;ID_Uses&#34;&#62;) = True Then&#13;&#10;      begin&#13;&#10;        If Pos(IntToStr(&#60;DM2.TbUses.&#34;ID_Uses&#34;&#62;) + ', ', ListNaznF) = 0 then&#13;&#10;        begin&#13;&#10;          If Not((Pos('для ', &#60;DM2.TbUses.&#34;Name&#34;&#62;) &#62; 0) or (Pos('Для ', &#60;DM2.TbUses.&#34;Name&#34;&#62;) &#62; 0)) then&#13;&#10;            NaznFunk := NaznFunk + 'для ' + Lowercase(Copy(Trim(&#60;DM2.TbUses.&#34;Name&#34;&#62;), 1, 1)) +&#13;&#10;                   Copy(Trim(&#60;DM2.TbUses.&#34;Name&#34;&#62;), 2, Length(Trim(&#60;DM2.TbUses.&#34;Name&#34;&#62;))) + ' та '&#13;&#10;          else&#13;&#10;            NaznFunk := NaznFunk + Lowercase(Copy(Trim(&#60;DM2.TbUses.&#34;Name&#34;&#62;), 1, 1)) +&#13;&#10;                   Copy(Trim(&#60;DM2.TbUses.&#34;Name&#34;&#62;), 2, Length(Trim(&#60;DM2.TbUses.&#34;Name&#34;&#62;))) + ' та ';&#13;&#10;&#13;&#10;          ListNaznF := ListNaznF + IntToStr(&#60;DM2.TbUses.&#34;ID_Uses&#34;&#62;) + ', ';&#13;&#10;        end;&#13;&#10;      end;&#13;&#10;&#13;&#10;      Users.Next;&#13;&#10;    end;&#13;&#10;&#13;&#10;    If LeaseN = false then&#13;&#10;    begin&#13;&#10;      NameKtoSkr := Copy(NameKtoSkr, 1, Length(NameKtoSkr) - 2);&#13;&#10;      NameKomu   := Copy(NameKomu, 1, Length(NameKomu) - 2);&#13;&#10;    end;&#13;&#10;&#13;&#10;    NaznFunk := Copy(NaznFunk, 1, Length(NaznFunk) - 4);&#13;&#10;  end;&#13;&#10;&#13;&#10;  //------------------------------------------------------------------------------------------------&#13;&#10;  // Документ подтверждающий право&#13;&#10;&#13;&#10;  //Проверяем документы в аренде&#13;&#10;  Decision.SQL.Text := 'SET DATEFORMAT dmy; Select Distinct D.Name, D.Dec_Date, D.Dec_Num From [Object] O, Lease A, ' +&#13;&#10;              'LeasePoly LP, Decision D Where (O.ID_Object in (' + Trim(ID_Objects) +&#13;&#10;              ')) And (LP.ID_Object = O.ID_Object) And (A.ID_Lease = LP.ID_Lease) And ' +&#13;&#10;              '(A.DateFirst &#60; GETDATE()) And ((A.DateLast &#62; GETDATE()) or (A.DateLast is Null )) ' +&#13;&#10;              'And (D.ID_Decision = A.ID_Decision)';&#13;&#10;  Decision.Open;&#13;&#10;&#13;&#10;  If Decision.RecordCount = 0 then //Если документов в аренде или самой аренды не нашло, тогда&#13;&#10;  begin                            //ищем в собственности&#13;&#10;    Decision.Close;&#13;&#10;    Decision.SQL.Text := 'SET DATEFORMAT dmy; Select Distinct D.Name, D.Dec_Date, D.Dec_Num From UserRec U, Decision D ' +&#13;&#10;                'Where (U.ID_Object in (' + Trim(ID_Objects) +')) And (U.DateFirst &#60;= GETDATE()) ' +&#13;&#10;                'And (U.DateLast Is Null Or U.DateLast &#62; GETDATE()) And ' +&#13;&#10;                '(D.ID_Decision = U.ID_Decision)';&#13;&#10;    Decision.Open;&#13;&#10;  end;&#13;&#10;&#13;&#10;  DocPrav := ''; //Документы подтверждающие право&#13;&#10;&#13;&#10;  If Decision.RecordCount &#62; 0 then&#13;&#10;  begin&#13;&#10;    Decision.First;&#13;&#10;&#13;&#10;    While Decision.EOF = false do&#13;&#10;    begin&#13;&#10;      DocPrav := DocPrav + LowerCase(Copy(Trim(&#60;Decision.&#34;Name&#34;&#62;), 1, Pos(' ', Trim(&#60;Decision.&#34;Name&#34;&#62;) + ' ') - 1)) + ' ';&#13;&#10;&#13;&#10;      If &#60;Decision.&#34;Dec_Date&#34;&#62; &#62; 0 then&#13;&#10;         DocPrav := DocPrav + 'від ' + DateToStr(&#60;Decision.&#34;Dec_Date&#34;&#62;) + ' р. ';&#13;&#10;&#13;&#10;      If Length(Trim(&#60;Decision.&#34;Dec_Num&#34;&#62;)) &#62; 0 then&#13;&#10;         DocPrav := DocPrav + '№ ' + &#60;Decision.&#34;Dec_Num&#34;&#62;;&#13;&#10;&#13;&#10;      DocPrav := DocPrav + ', ';&#13;&#10;&#13;&#10;      Decision.Next;&#13;&#10;    end;&#13;&#10;&#13;&#10;    DocPrav := Copy(DocPrav, 1, Length(DocPrav) - 2);&#13;&#10;  end;&#13;&#10;&#13;&#10;  //-----------------------------------------------------------------------------------------------&#13;&#10;  // Ограничения и сервитуты&#13;&#10;&#13;&#10;  ObmN  := 'відсутні'; //Наличие ограничений&#13;&#10;  ServN := 'немає'; //Наличие сервитутов&#13;&#10;&#13;&#10;  Temp.SQL.Text := 'SET DATEFORMAT dmy; Select L.* From [Object] O, Limination L ' +&#13;&#10;                'Where (O.ID_Object = ' + IntToStr(&#60;DM1.QbObject.&#34;ID_Object&#34;&#62;) +&#13;&#10;                ') And (L.ID_Object = O.ID_Object) And (L.DateFirst &#60; GETDATE()) And ' +&#13;&#10;                '((L.ID_TypeTermin = 0) or ((L.ID_TypeTermin = 1) and ((L.DateLast &#62; GETDATE()) ' +&#13;&#10;                'or (L.DateLast is Null ))))';&#13;&#10;  Temp.Open;&#13;&#10;&#13;&#10;  If Temp.RecordCount &#62; 0 then&#13;&#10;    ObmN := 'наявні';&#13;&#10;&#13;&#10;  Temp.Close;&#13;&#10;  Temp.SQL.Text := 'SET DATEFORMAT dmy; Select S.* From [Object] O, Servitut S ' +&#13;&#10;                'Where (O.ID_Object = ' + IntToStr(&#60;DM1.QbObject.&#34;ID_Object&#34;&#62;) +&#13;&#10;                ') And (S.ID_Object = O.ID_Object) And (S.DateFirst &#60; GETDATE()) And ' +&#13;&#10;                '((S.ID_TypeTermin = 0) or ((S.ID_TypeTermin = 1) and ((S.DateLast &#62; GETDATE()) ' +&#13;&#10;                'or (S.DateLast is Null ))))';&#13;&#10;  Temp.Open;&#13;&#10;&#13;&#10;  If Temp.RecordCount &#62; 0 then&#13;&#10;    ServN := 'наявні';&#13;&#10;&#13;&#10;  Temp.Close;&#13;&#10;&#13;&#10;  //-----------------------------------------------------------------------------------------------&#13;&#10;  // Закрываем таблицы&#13;&#10;&#13;&#10;  Arenda.Close;&#13;&#10;  Users.Close;&#13;&#10;  Decision.Close;&#13;&#10;&#13;&#10;  UsrData.RowCount := iUser;&#13;&#10;end." PropData="044C65667403C00203546F70025008446174617365747301010C2600000020446174615365743D224172656E64612220446174615365744E616D653D224172656E64612200010C2A00000020446174615365743D224465636973696F6E2220446174615365744E616D653D224465636973696F6E2200010C3300000020446174615365743D22444D312E6651624F626A6563742220446174615365744E616D653D22444D312E51624F626A6563742200010C3500000020446174615365743D22444D312E66516954656368446F632220446174615365744E616D653D22444D312E516954656368446F632200010C2F00000020446174615365743D22444D312E6651734669726D2220446174615365744E616D653D22444D312E51734669726D2200010C3300000020446174615365743D22444D312E66517350656F706C652220446174615365744E616D653D22444D312E517350656F706C652200010C3B00000020446174615365743D22444D322E6654625479706547726F756E642220446174615365744E616D653D22444D322E54625479706547726F756E642200010C2F00000020446174615365743D22444D322E665462557365732220446174615365744E616D653D22444D322E5462557365732200010C2200000020446174615365743D2254656D702220446174615365744E616D653D2254656D702200010C2400000020446174615365743D2255736572732220446174615365744E616D653D225573657273220000095661726961626C65730100055374796C650100">
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="27" RightMargin="10" TopMargin="15" BottomMargin="13" ColumnWidth="0" ColumnPositions.Text="" LargeDesignHeight="True" HGuides.Text="" VGuides.Text="">
    <TfrxMasterData Name="MasterData1" Height="26,45671" Left="0" Top="18,89765" Width="653,85869" ColumnWidth="0" ColumnGap="0" RowCount="1">
      <TfrxMemoView Name="Memo1" Left="476,22078" Top="-2,72004641033163E-15" Width="128,50402" Height="22,67718" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" Text="Р—РђРўР’Р•Р Р”Р–Р•РќРћ"/>
    </TfrxMasterData>
    <TfrxMasterData Name="UsrData" Height="52,91342" Left="0" Top="68,03154" Width="653,85869" OnBeforePrint="UsrDataOnBeforePrint" ColumnWidth="0" ColumnGap="0" RowCount="3">
      <TfrxMemoView Name="Memo2" Left="423,30736" Top="22,67718" Width="124,72449" Height="11,33859" Font.Charset="1" Font.Color="12632256" Font.Height="-9" Font.Name="Times New Roman" Font.Style="2" Frame.Typ="4" HAlign="haCenter" ParentFont="False" Text="(РїС–РґРїРёСЃ)"/>
      <TfrxMemoView Name="Memo3" Left="548,03185" Top="22,67718" Width="105,82684" Height="11,33859" Font.Charset="1" Font.Color="12632256" Font.Height="-9" Font.Name="Times New Roman" Font.Style="2" HAlign="haCenter" ParentFont="False" Text="(РїСЂС–Р·РІРёС‰Рµ С‚Р° С–РЅС–С†С–Р°Р»Рё)"/>
      <TfrxMemoView Name="Memo4" Left="548,03185" Top="3,77953" Width="105,82684" Height="18,89765" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="2" HAlign="haCenter" ParentFont="False" Text="[Pidps]"/>
      <TfrxMemoView Name="Memo5" Left="419,52783" Top="34,01577" Width="234,33086" Height="18,89765" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="2" HAlign="haCenter" ParentFont="False" Text="____ _____________ 20____ СЂ."/>
    </TfrxMasterData>
    <TfrxMasterData Name="MasterData3" Height="532,91373" Left="0" Top="143,62214" Width="653,85869" AllowSplit="True" ColumnWidth="0" ColumnGap="0" RowCount="1" Stretched="True">
      <TfrxMemoView Name="Memo6" Align="baCenter" Left="198,425325" Top="18,89765" Width="257,00804" Height="60,47248" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="3" HAlign="haCenter" ParentFont="False" Text="Р—РђР’Р”РђРќРќРЇ в„–___________&#13;&#10;РІС–Рґ _________________&#13;&#10;РЅР° РІРёРєРѕРЅР°РЅРЅСЏ СЂРѕР±С–С‚"/>
      <TfrxMemoView Name="Memo7" Left="0" Top="94,48825" Width="653,85869" Height="438,42548" StretchMode="smActualHeight" AllowHTMLTags="True" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="2" HAlign="haBlock" ParagraphGap="35" ParentFont="False" Text="&#60;b&#62;Р’РёРєРѕРЅСѓРІР°РЅР° СЂРѕР±РѕС‚Р°:&#60;/b&#62; &#60;u&#62;Р РѕР·СЂРѕР±РєР° РїСЂРѕРµРєС‚Сѓ Р·РµРјР»РµСѓСЃС‚СЂРѕСЋ С‰РѕРґРѕ РІС–РґРІРµРґРµРЅРЅСЏ Р·РµРјРµР»СЊРЅРѕС— РґС–Р»СЏРЅРєРё [Otveden] [NameKomu] [NaznFunk] Р·Р° СЂР°С…СѓРЅРѕРє РєР°С‚РµРіРѕСЂС–С— [KatZeml] РЅР° С‚РµСЂРёС‚РѕСЂС–С— [Teritor].&#60;/u&#62;&#13;&#10;&#13;&#10;&#60;b&#62;РџС–РґСЃС‚Р°РІРѕСЋ РґР»СЏ РІРёРєРѕРЅР°РЅРЅСЏ СЂРѕР±РѕС‚Рё С”:&#60;/b&#62; &#60;u&#62;[DocPrav].&#60;/u&#62;&#13;&#10; &#13;&#10;&#60;b&#62;РҐР°СЂР°РєС‚РµСЂРёСЃС‚РёРєР° РѕР±'С”РєС‚Р°:&#60;/b&#62;&#13;&#10;1) &#60;b&#62;РјС–СЃС†Рµ СЂРѕР·С‚Р°С€СѓРІР°РЅРЅСЏ:&#60;/b&#62; &#60;u&#62;РЅР° С‚РµСЂРёС‚РѕСЂС–С— [Teritor].&#60;/u&#62;&#13;&#10;2) &#60;b&#62;С„РѕСЂРјР° РІР»Р°СЃРЅРѕСЃС‚С–, РєР°С‚РµРіРѕСЂС–СЏ Р·РµРјРµР»СЊ, Р·Р° СЂР°С…СѓРЅРѕРє СЏРєРёС… РІРёРєРѕРЅСѓС”С‚СЊСЃСЏ РІС–РґРІРµРґРµРЅРЅСЏ:&#60;/b&#62; &#60;u&#62;СЂРѕР·РјРµР¶СѓРІР°РЅРЅСЏ РЅРµ РїСЂРѕРІРѕРґРёР»РѕСЃСЊ, РєР°С‚РµРіРѕСЂС–С— [KatZeml] РЅР° С‚РµСЂРёС‚РѕСЂС–С— [SilRad].&#60;/u&#62;&#13;&#10;3) &#60;b&#62;С†С–Р»СЊРѕРІРµ РїСЂРёР·РЅР°С‡РµРЅРЅСЏ&#60;/b&#62; &#60;u&#62;[NaznFunk].&#60;/u&#62;&#13;&#10;&#13;&#10;&#60;b&#62;Р’РёС…С–РґРЅС– РґР°РЅС–:&#60;/b&#62;&#13;&#10;1) СЂРѕР·РјС–СЂ Р·РµРјРµР»СЊРЅРёС… РґС–Р»СЏРЅРѕРє &#60;u&#62;[FormatFloat(fdLandAreaG, SumArea/10000)] РіР°&#60;/u&#62;;&#13;&#10;2) РІРёРєРѕРїС–СЋРІР°РЅРЅСЏ  Р·  РїР»Р°РЅСѓ  Р·РµРјР»РµРєРѕСЂРёСЃС‚СѓРІР°РЅРЅСЏ;&#13;&#10;3) РЅР°СЏРІРЅС– РѕР±РјРµР¶РµРЅРЅСЏ вЂ“ &#60;u&#62;[ObmN];&#60;/u&#62;&#13;&#10;4) Р·РµРјРµР»СЊРЅС– СЃРµСЂРІС–С‚СѓС‚Рё вЂ“ [ServN];&#13;&#10;5) СѓРјРѕРІРё РЅР°РґР°РЅРЅСЏ Р·РµРјРµР»СЊРЅРёС… РґС–Р»СЏРЅРѕРє вЂ“ &#60;u&#62;[Otveden].&#60;/u&#62;&#13;&#10;&#13;&#10;&#60;b&#62;Р”РѕРєСѓРјРµРЅС‚Рё С– РјР°С‚РµСЂС–Р°Р»Рё, С‰Рѕ РїРѕРІРёРЅРЅС– Р±СѓС‚Рё РїСЂРµРґСЃС‚Р°РІР»РµРЅС– Р·Р° СЂРµР·СѓР»СЊС‚Р°С‚Р°РјРё РІРёРєРѕРЅР°РЅРёС… СЂРѕР±С–С‚:&#60;/b&#62; &#60;u&#62;РїСЂРѕРµРєС‚ Р·РµРјР»РµСѓСЃС‚СЂРѕСЋ С‰РѕРґРѕ РІС–РґРІРµРґРµРЅРЅСЏ Р·РµРјРµР»СЊРЅРѕС— РґС–Р»СЏРЅРєРё [Otveden] [NameKomu].&#60;/u&#62;&#13;&#10;&#13;&#10;&#60;b&#62;РџСЂРѕРµРєС‚ Р·РµРјР»РµСѓСЃС‚СЂРѕСЋ С‰РѕРґРѕ РІС–РґРІРµРґРµРЅРЅСЏ Сѓ РІР»Р°СЃРЅС–СЃС‚СЊ Р·РµРјРµР»СЊРЅРёС… РґС–Р»СЏРЅРѕРє&#60;/b&#62; РІРёРіРѕС‚РѕРІР»СЏС”С‚СЊСЃСЏ Сѓ РґРІРѕС… РїСЂРёРјС–СЂРЅРёРєР°С…."/>
    </TfrxMasterData>
    <TfrxADOQuery Name="Arenda" UserName="Arenda" CloseDataSource="True" FieldAliases.Text="" SQL.Text="" CommandTimeout="30" PropData="0A506172616D65746572730100"/>
    <TfrxADOQuery Name="Temp" UserName="Temp" CloseDataSource="True" FieldAliases.Text="" SQL.Text="" CommandTimeout="30" PropData="0A506172616D65746572730100"/>
    <TfrxADOQuery Name="Users" UserName="Users" CloseDataSource="True" FieldAliases.Text="" SQL.Text="" CommandTimeout="30" PropData="0A506172616D65746572730100"/>
    <TfrxMasterData Name="MasterData4" Height="90,70872" Left="0" Top="699,21305" Width="653,85869" ColumnWidth="0" ColumnGap="0" RowCount="1" Stretched="True">
      <TfrxMemoView Name="Memo8" Left="0" Top="71,81107" Width="260,78757" Height="18,89765" StretchMode="smActualHeight" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" Text="Р”РёСЂРµРєС‚РѕСЂ [IspName]"/>
      <TfrxMemoView Name="Memo9" Left="427,08689" Top="71,81107" Width="188,9765" Height="18,89765" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Times New Roman" Font.Style="3" ParentFont="False" VAlign="vaBottom" Text="[ShortFamily(IspDir)]"/>
    </TfrxMasterData>
    <TfrxADOQuery Name="Decision" UserName="Decision" CloseDataSource="True" FieldAliases.Text="" SQL.Text="" CommandTimeout="30" PropData="0A506172616D65746572730100"/>
    <TfrxMasterData Name="MasterData2" Height="41,57483" Left="0" Top="812,59895" Width="653,85869" ColumnWidth="0" ColumnGap="0" RowCount="1">
      <TfrxMemoView Name="Memo10" Left="427,08689" Top="4,44089209850063E-15" Width="120,94496" Height="18,89765" Font.Charset="1" Font.Color="12632256" Font.Height="-11" Font.Name="Times New Roman" Font.Style="2" HAlign="haCenter" ParentFont="False" Text="(РїСЂС–Р·РІРёС‰Рµ С‚Р° С–РЅС–С†С–Р°Р»Рё)"/>
      <TfrxMemoView Name="Memo11" Left="264,5671" Top="4,44089209850063E-15" Width="120,94496" Height="18,89765" Font.Charset="1" Font.Color="12632256" Font.Height="-11" Font.Name="Times New Roman" Font.Style="2" Frame.Typ="4" HAlign="haCenter" ParentFont="False" Text="(РїС–РґРїРёСЃ)"/>
      <TfrxMemoView Name="Memo12" Left="0" Top="18,89765" Width="49,13389" Height="22,67718" Font.Charset="1" Font.Color="12632256" Font.Height="-16" Font.Name="Times New Roman" Font.Style="2" HAlign="haCenter" ParentFont="False" Text="РњРџ"/>
    </TfrxMasterData>
  </TfrxReportPage>
</TfrxReport>
